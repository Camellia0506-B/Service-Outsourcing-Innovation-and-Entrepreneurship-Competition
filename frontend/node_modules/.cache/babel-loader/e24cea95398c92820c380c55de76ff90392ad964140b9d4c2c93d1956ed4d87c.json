{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, computed, onMounted, onUnmounted, nextTick } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { themeEventBus } from '@/utils/themeEvent';\nimport { dashboardAPI } from '@/api/dashboard';\nimport { followListAPI, followAddAPI, followDeleteAPI } from '@/api/follows';\nimport { universitiesAPI, univNoticesAPI, univPostsAPI } from '@/api/universities';\nexport default {\n  name: 'CalendarWithDailyCard',\n  setup() {\n    const quote = ref('');\n    const bgImageUrl = ref('');\n    const ddlReminders = ref([]);\n    const hotPosts = ref([]);\n    const nickname = ref('');\n    const currentDate = ref(new Date());\n    const isMobileView = ref(false);\n    const userId = ref(0);\n    const followedUnivs = ref([]);\n    const selectedUniv = ref('');\n    const showAddModal = ref(false);\n    const isLoading = ref(false);\n\n    // å¼¹çª—æœç´¢å’Œç­›é€‰\n    const searchKeyword = ref('');\n    const selectedRegion = ref('');\n\n    // å­˜å‚¨ univ_name -> {followId, univId} çš„æ˜ å°„\n    const univMap = ref({});\n    const router = useRouter();\n    const goPostDetail = postId => {\n      if (!postId) return;\n      // âœ… æŒ‰ä½ è·¯ç”±é…ç½®æ”¹ï¼šæ¯”å¦‚ /posts/detail/:id\n      router.push({\n        path: `/main/posts/detail/${postId}`\n      });\n      // æˆ–è€…ï¼šrouter.push({ name: 'PostDetail', params: { id: postId } })\n    };\n\n    // Toast æç¤º\n    const toast = ref({\n      show: false,\n      message: '',\n      type: 'success' // success | error\n    });\n    const showToast = (message, type = 'success') => {\n      toast.value = {\n        show: true,\n        message,\n        type\n      };\n      setTimeout(() => {\n        toast.value.show = false;\n      }, 3000);\n    };\n    const currentDay = computed(() => currentDate.value.getDate());\n    const daysInMonth = computed(() => {\n      return new Date(currentDate.value.getFullYear(), currentDate.value.getMonth() + 1, 0).getDate();\n    });\n    const dayOfWeek = computed(() => {\n      const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n      return days[currentDate.value.getDay()];\n    });\n    const quoteText = computed(() => {\n      const raw = (quote.value || '').trim();\n      if (!raw) return '';\n      const [textPart] = raw.split('##');\n      return (textPart || '').trim().replace(/\\\\n/g, '\\n');\n    });\n    const quoteAuthor = computed(() => {\n      const raw = (quote.value || '').trim();\n      if (!raw) return '';\n      const parts = raw.split('##');\n      if (parts.length < 2) return '';\n      return (parts.slice(1).join('##') || '').trim();\n    });\n\n    // å­˜å‚¨æ‰€æœ‰å¯ç”¨çš„å¤§å­¦ä¿¡æ¯ï¼ˆåŒ…å« univ_idï¼‰\n    const allUnivs = ref([]);\n\n    // å­˜å‚¨æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥åˆ—è¡¨ï¼ˆåˆå¹¶åçš„ï¼‰\n    const allNotices = ref([]);\n\n    // å¼ºåˆ¶åˆ·æ–°æ ‡è®°ï¼ˆç”¨äºè§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—ï¼‰\n    const refreshTrigger = ref(0);\n    const availableUnivs = computed(() => {\n      // ä¼˜å…ˆä» allUnivs è·å–\n      if (allUnivs.value.length > 0) {\n        return allUnivs.value.map(u => u.univ_name).sort();\n      }\n\n      // å…œåº•ï¼šä» ddlReminders ä¸­æå–\n      const set = new Set();\n      ddlReminders.value.forEach(item => {\n        if (item?.univ_name) set.add(item.univ_name);\n      });\n      return Array.from(set).sort();\n    });\n\n    // æå–æ‰€æœ‰åœ°åŒº\n    const availableRegions = computed(() => {\n      const regions = new Set();\n      allUnivs.value.forEach(u => {\n        // ä»å¤§å­¦åç§°ä¸­æå–åœ°åŒºï¼ˆå¦‚ï¼šä¸Šæµ·ã€åŒ—äº¬ã€æ±Ÿè‹ç­‰ï¼‰\n        const match = u.univ_name.match(/^(ä¸Šæµ·|åŒ—äº¬|å¤©æ´¥|é‡åº†|æ±Ÿè‹|æµ™æ±Ÿ|å¹¿ä¸œ|å››å·|æ¹–åŒ—|å±±ä¸œ|é™•è¥¿|è¾½å®|æ¹–å—|ç¦å»º|æ²³å—|æ²³åŒ—|å®‰å¾½|é»‘é¾™æ±Ÿ|å‰æ—|äº‘å—|å±±è¥¿|æ±Ÿè¥¿|è´µå·|å¹¿è¥¿|ç”˜è‚ƒ|å†…è’™å¤|æ–°ç–†|æµ·å—|å®å¤|é’æµ·|è¥¿è—|é¦™æ¸¯|æ¾³é—¨|å°æ¹¾)/);\n        if (match) {\n          regions.add(match[1]);\n        }\n      });\n      return Array.from(regions).sort();\n    });\n\n    // è¿‡æ»¤åçš„å¤§å­¦åˆ—è¡¨\n    const filteredUnivs = computed(() => {\n      let list = allUnivs.value;\n\n      // æŒ‰åœ°åŒºç­›é€‰\n      if (selectedRegion.value) {\n        list = list.filter(u => u.univ_name.startsWith(selectedRegion.value));\n      }\n\n      // æŒ‰å…³é”®è¯æœç´¢\n      if (searchKeyword.value.trim()) {\n        const keyword = searchKeyword.value.trim().toLowerCase();\n        list = list.filter(u => u.univ_name.toLowerCase().includes(keyword));\n      }\n      return list.map(u => u.univ_name).sort();\n    });\n    const filteredDdlReminders = computed(() => {\n      // ä¾èµ– refreshTrigger æ¥å¼ºåˆ¶é‡æ–°è®¡ç®—\n      const _ = refreshTrigger.value;\n\n      // ä½¿ç”¨åˆå¹¶åçš„é€šçŸ¥åˆ—è¡¨ï¼ˆæ¥è‡ª dashboard çš„ ddlReminders + åŠ¨æ€åŠ è½½çš„ allNoticesï¼‰\n      const mergedList = [...ddlReminders.value, ...allNotices.value];\n      console.log('[Debug] Computing filteredDdlReminders:', {\n        refreshTrigger: refreshTrigger.value,\n        ddlReminders: ddlReminders.value.length,\n        allNotices: allNotices.value.length,\n        merged: mergedList.length,\n        followedUnivs: followedUnivs.value\n      });\n\n      // å»é‡ï¼šæ ¹æ® id å»é‡\n      const uniqueMap = new Map();\n      mergedList.forEach(item => {\n        if (item?.id || item?.notice_id) {\n          const key = item.id || item.notice_id;\n          if (!uniqueMap.has(key)) {\n            uniqueMap.set(key, item);\n          }\n        }\n      });\n      let list = Array.from(uniqueMap.values()).filter(item => {\n        const included = followedUnivs.value.includes(item.univ_name);\n        if (!included) {\n          console.log('[Debug] Filtering out:', item.univ_name, 'not in', followedUnivs.value);\n        }\n        return included;\n      });\n      console.log('[Debug] After follow filter:', list.length);\n      if (selectedUniv.value) {\n        list = list.filter(item => item.univ_name === selectedUniv.value);\n      }\n      const mapped = list.map(it => ({\n        ...it,\n        _days: getDaysLeft(it),\n        _past: hasPast(it)\n      }));\n\n      // æ’åºï¼šæœªè¿‡æœŸçš„æŒ‰å‰©ä½™å¤©æ•°å‡åºï¼Œå·²è¿‡æœŸçš„æ”¾æœ€å\n      mapped.sort((a, b) => {\n        // å¦‚æœä¸€ä¸ªè¿‡æœŸä¸€ä¸ªæ²¡è¿‡æœŸï¼Œæ²¡è¿‡æœŸçš„æ’å‰é¢\n        if (a._past !== b._past) {\n          return a._past ? 1 : -1;\n        }\n\n        // éƒ½æœªè¿‡æœŸæˆ–éƒ½è¿‡æœŸï¼ŒæŒ‰å¤©æ•°æ’åº\n        if (a._days === '--' && b._days === '--') return 0;\n        if (a._days === '--') return 1;\n        if (b._days === '--') return -1;\n        return a._days - b._days;\n      });\n      console.log('[Debug] Final filtered list:', mapped.length);\n      return mapped;\n    });\n    const checkScreenSize = () => {\n      isMobileView.value = window.innerWidth < 1200;\n    };\n    const toStaticUrl = p => {\n      if (!p) return '';\n      if (p.startsWith('http')) return p;\n      if (p.startsWith('/static')) return p;\n      return '/static/' + p.replace(/^\\/+/, '');\n    };\n    const parseDate = s => {\n      if (!s) return null;\n      if (typeof s === 'number') return new Date(s);\n      const str = String(s).trim();\n      if (str.includes(' ')) return new Date(str.replace(' ', 'T'));\n      if (str.includes('/')) return new Date(str.replaceAll('/', '-'));\n      return new Date(str + 'T23:59:59');\n    };\n\n    // âœ… å›ºå®šèµ·ç‚¹ï¼š2025-01-01\n    const BASE_DATE = new Date('2025-01-01T00:00:00');\n    const calcDaysLeft = endDateStr => {\n      const end = parseDate(endDateStr);\n      if (!end || isNaN(end.getTime())) return '--';\n\n      // âœ… ä»å›ºå®šèµ·ç‚¹ç®—ï¼ˆè€Œä¸æ˜¯ä»ä»Šå¤©ç®—ï¼‰\n      const diff = end.getTime() - BASE_DATE.getTime();\n      return diff <= 0 ? 0 : Math.ceil(diff / (1000 * 60 * 60 * 24));\n    };\n    const hasPast = item => {\n      if (item?.end_date) {\n        const end = parseDate(item.end_date);\n        if (!end || isNaN(end.getTime())) return false;\n\n        // âœ… æ˜¯å¦\"æ—©äºå›ºå®šèµ·ç‚¹\"\n        return end.getTime() < BASE_DATE.getTime();\n      }\n      return typeof item?.days_left === 'number' && item.days_left < 0;\n    };\n    const getDaysLeft = item => {\n      if (item?.end_date) return calcDaysLeft(item.end_date);\n      if (typeof item?.days_left === 'number') return Math.max(0, item.days_left);\n      return '--';\n    };\n    const countdownText = item => {\n      const d = getDaysLeft(item);\n      if (d === '--') return 'æˆªæ­¢æœªçŸ¥';\n      if (hasPast(item) || d === 0) return 'å·²æˆªæ­¢';\n      return `å‰© ${d} å¤©`;\n    };\n\n    // æ‰“å¼€é€šçŸ¥é“¾æ¥\n    const openNoticeLink = item => {\n      if (item?.source_link) {\n        // ç¡®ä¿é“¾æ¥æœ‰åè®®å‰ç¼€\n        let url = item.source_link;\n        if (!url.startsWith('http://') && !url.startsWith('https://')) {\n          url = 'https://' + url;\n        }\n        window.open(url, '_blank');\n      }\n    };\n\n    // é‡ç½®å¼¹çª—æœç´¢ç­›é€‰\n    const resetModalFilters = () => {\n      searchKeyword.value = '';\n      selectedRegion.value = '';\n    };\n\n    // æ‰“å¼€å¼¹çª—æ—¶é‡ç½®ç­›é€‰\n    const openAddModal = () => {\n      resetModalFilters();\n      showAddModal.value = true;\n    };\n\n    // ä»åç«¯åŠ è½½å…³æ³¨åˆ—è¡¨\n    const loadFollowedUnivs = async () => {\n      try {\n        const res = await followListAPI(userId.value);\n        console.log('[Debug] followListAPI response:', res);\n        if (res?.code === 200 && Array.isArray(res.data)) {\n          // æ„å»ºæ˜ å°„è¡¨\n          univMap.value = {};\n          followedUnivs.value = [];\n          res.data.forEach(item => {\n            // å¦‚æœåç«¯è¿”å›äº† univ_nameï¼Œç›´æ¥ä½¿ç”¨\n            let univName = item.univ_name;\n\n            // å¦‚æœæ²¡æœ‰ univ_nameï¼Œä» allUnivs ä¸­æŸ¥æ‰¾\n            if (!univName && item.univ_id) {\n              const univ = allUnivs.value.find(u => u.univ_id === item.univ_id);\n              univName = univ?.univ_name;\n            }\n            if (univName) {\n              followedUnivs.value.push(univName);\n              univMap.value[univName] = {\n                followId: item.id,\n                univId: item.univ_id\n              };\n            } else {\n              console.warn('[Debug] Cannot find univ_name for:', item);\n            }\n          });\n          console.log('[Debug] Loaded follows:', followedUnivs.value);\n          console.log('[Debug] UnivMap:', univMap.value);\n        }\n      } catch (e) {\n        console.error('Failed to load followed univs:', e);\n        showToast('åŠ è½½å…³æ³¨åˆ—è¡¨å¤±è´¥', 'error');\n      }\n    };\n\n    // åŠ è½½æ‰€æœ‰å¯ç”¨çš„å¤§å­¦åˆ—è¡¨\n    const loadAllUniversities = async () => {\n      try {\n        // è·å–æ‰€æœ‰å¤§å­¦ï¼ˆä¸åˆ†é¡µï¼Œè®¾ç½®è¾ƒå¤§çš„ sizeï¼‰\n        const res = await universitiesAPI({\n          page: 1,\n          size: 1000\n        });\n        if (res?.code === 200 && res?.data?.list) {\n          allUnivs.value = res.data.list.map(u => ({\n            univ_id: u.id,\n            univ_name: u.name,\n            logo_url: u.logo_url,\n            tags: u.tags,\n            intro: u.intro\n          }));\n          console.log('[Debug] Loaded universities:', allUnivs.value.length);\n        }\n      } catch (e) {\n        console.error('Failed to load universities:', e);\n      }\n    };\n\n    // åŠ è½½æŸä¸ªå¤§å­¦çš„é€šçŸ¥åˆ—è¡¨\n    const loadUnivNotices = async (univId, univName) => {\n      try {\n        console.log('[Debug] Loading notices for:', {\n          univId,\n          univName\n        });\n        const res = await univNoticesAPI(univId);\n        console.log('[Debug] univNoticesAPI response:', res);\n        if (res?.code === 200) {\n          // åç«¯è¿”å›çš„ç»“æ„æ˜¯ {code: 200, data: {info: {...}, notices: [...]}}\n          const noticesData = res.data?.notices || res.data;\n          if (Array.isArray(noticesData)) {\n            // ç»™æ¯ä¸ªé€šçŸ¥æ·»åŠ  univ_name å’Œ univ_id\n            const notices = noticesData.map(notice => ({\n              ...notice,\n              id: notice.id,\n              // ä¿ç•™åŸå§‹ id\n              notice_id: notice.id,\n              // æ·»åŠ  notice_id ç”¨äºå»é‡\n              univ_id: univId,\n              univ_name: univName\n            }));\n            console.log('[Debug] Processed notices:', notices);\n            return notices;\n          }\n        }\n      } catch (e) {\n        console.error('Failed to load notices for', univName, e);\n      }\n      return [];\n    };\n\n    // æ‰¹é‡åŠ è½½æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥\n    const loadAllFollowedNotices = async () => {\n      console.log('[Debug] Loading all followed notices for:', followedUnivs.value);\n      const noticesPromises = [];\n      for (const univName of followedUnivs.value) {\n        const univInfo = univMap.value[univName];\n        if (univInfo?.univId) {\n          noticesPromises.push(loadUnivNotices(univInfo.univId, univName));\n        } else {\n          console.warn('[Debug] No univId found for:', univName);\n        }\n      }\n      const noticesArrays = await Promise.all(noticesPromises);\n      // åˆå¹¶æ‰€æœ‰é€šçŸ¥\n      allNotices.value = noticesArrays.flat();\n      console.log('[Debug] Total notices loaded:', allNotices.value.length);\n      console.log('[Debug] All loaded notices:', allNotices.value);\n    };\n\n    // åˆ‡æ¢å…³æ³¨çŠ¶æ€\n    const handleToggleFollow = async univName => {\n      if (isLoading.value) return;\n      const isFollowed = followedUnivs.value.includes(univName);\n      console.log('[Debug] Toggle follow:', {\n        univName,\n        isFollowed\n      });\n      if (isFollowed) {\n        await handleRemoveFollow(univName);\n      } else {\n        await handleAddFollow(univName);\n      }\n    };\n\n    // æ·»åŠ å…³æ³¨\n    const handleAddFollow = async univName => {\n      if (isLoading.value) return;\n\n      // æ£€æŸ¥æ˜¯å¦å·²ç»å…³æ³¨\n      if (followedUnivs.value.includes(univName)) {\n        console.log('[Debug] Already followed:', univName);\n        return; // ä¸æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œé™é»˜è¿”å›\n      }\n\n      // ä¼˜å…ˆä» allUnivs ä¸­æŸ¥æ‰¾\n      let univInfo = allUnivs.value.find(u => u.univ_name === univName);\n\n      // å…œåº•ï¼šä» ddlReminders ä¸­æŸ¥æ‰¾\n      if (!univInfo) {\n        univInfo = ddlReminders.value.find(item => item.univ_name === univName);\n      }\n      if (!univInfo?.univ_id) {\n        console.error('Cannot find univ_id for:', univName);\n        showToast('æ— æ³•æ‰¾åˆ°è¯¥å¤§å­¦ä¿¡æ¯', 'error');\n        return;\n      }\n      isLoading.value = true;\n      try {\n        console.log('[Debug] Adding follow:', {\n          univName,\n          univ_id: univInfo.univ_id\n        });\n        const res = await followAddAPI({\n          user_id: userId.value,\n          univ_id: univInfo.univ_id\n        });\n        console.log('[Debug] Add follow response:', res);\n        if (res?.code === 200) {\n          // åç«¯è¿”å›çš„ data æ˜¯ follow_id\n          const followId = res.data;\n\n          // ç¡®ä¿ä¸é‡å¤æ·»åŠ \n          if (!followedUnivs.value.includes(univName)) {\n            followedUnivs.value = [...followedUnivs.value, univName];\n            console.log('[Debug] Added to followedUnivs:', followedUnivs.value);\n          }\n          univMap.value = {\n            ...univMap.value,\n            [univName]: {\n              followId: followId,\n              univId: univInfo.univ_id\n            }\n          };\n          console.log('[Debug] Updated univMap:', univMap.value);\n\n          // ç«‹å³åŠ è½½è¯¥å¤§å­¦çš„é€šçŸ¥åˆ—è¡¨\n          console.log('[Debug] Starting to load notices for:', univName);\n          const notices = await loadUnivNotices(univInfo.univ_id, univName);\n          console.log('[Debug] Loaded notices count:', notices?.length || 0);\n          if (notices && notices.length > 0) {\n            // ä½¿ç”¨ Vue çš„å“åº”å¼æ›´æ–°æ–¹å¼\n            allNotices.value = [...allNotices.value, ...notices];\n            console.log('[Debug] Total allNotices after add:', allNotices.value.length);\n\n            // å¼ºåˆ¶è§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—\n            refreshTrigger.value++;\n            console.log('[Debug] Triggered refresh:', refreshTrigger.value);\n\n            // ç­‰å¾… Vue æ›´æ–° DOM\n            await nextTick();\n            console.log('[Debug] After nextTick, filteredDdlReminders count:', filteredDdlReminders.value.length);\n          } else {\n            console.warn('[Debug] No notices loaded for', univName);\n          }\n          await nextTick();\n          await refreshHotPosts();\n          showToast('å…³æ³¨æˆåŠŸ', 'success');\n        } else {\n          showToast(res?.msg || 'å…³æ³¨å¤±è´¥', 'error');\n        }\n      } catch (e) {\n        console.error('Failed to add follow:', e);\n        // å¦‚æœæ˜¯é‡å¤å…³æ³¨é”™è¯¯ï¼Œç»™å‡ºæ›´å‹å¥½çš„æç¤º\n        if (e?.message?.includes('Duplicate')) {\n          console.log('[Debug] Duplicate follow detected, reloading follows');\n          // é‡æ–°åŒæ­¥å…³æ³¨åˆ—è¡¨\n          await loadFollowedUnivs();\n        } else {\n          showToast('å…³æ³¨å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');\n        }\n      } finally {\n        isLoading.value = false;\n      }\n    };\n\n    // å–æ¶ˆå…³æ³¨\n    const handleRemoveFollow = async univName => {\n      if (isLoading.value) return;\n      const univInfo = univMap.value[univName];\n      if (!univInfo?.followId) {\n        console.error('Cannot find follow_id for:', univName);\n        console.log('[Debug] Current univMap:', univMap.value);\n        showToast('æ— æ³•æ‰¾åˆ°å…³æ³¨è®°å½•', 'error');\n        return;\n      }\n      isLoading.value = true;\n      try {\n        console.log('[Debug] Removing follow:', {\n          univName,\n          followId: univInfo.followId\n        });\n        const res = await followDeleteAPI(univInfo.followId);\n        console.log('[Debug] Remove follow response:', res);\n        if (res?.code === 200) {\n          // ä»æœ¬åœ°æ•°ç»„ä¸­ç§»é™¤\n          const index = followedUnivs.value.indexOf(univName);\n          if (index > -1) {\n            followedUnivs.value.splice(index, 1);\n          }\n          const univId = univMap.value[univName]?.univId;\n          delete univMap.value[univName];\n\n          // åˆ é™¤è¯¥å¤§å­¦çš„æ‰€æœ‰é€šçŸ¥\n          if (univId) {\n            const beforeCount = allNotices.value.length;\n            allNotices.value = allNotices.value.filter(notice => notice.univ_id !== univId);\n            const afterCount = allNotices.value.length;\n            console.log('[Debug] Removed notices:', beforeCount - afterCount);\n\n            // å¼ºåˆ¶è§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—\n            refreshTrigger.value++;\n          }\n\n          // å¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¢«åˆ é™¤çš„å­¦æ ¡ï¼Œæ¸…ç©ºé€‰ä¸­\n          if (selectedUniv.value === univName) {\n            selectedUniv.value = '';\n          }\n          await nextTick();\n          await refreshHotPosts();\n          showToast('å·²å–æ¶ˆå…³æ³¨', 'success');\n        } else {\n          showToast(res?.msg || 'å–æ¶ˆå…³æ³¨å¤±è´¥', 'error');\n        }\n      } catch (e) {\n        console.error('Failed to remove follow:', e);\n        showToast('å–æ¶ˆå…³æ³¨å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');\n      } finally {\n        isLoading.value = false;\n      }\n    };\n    const dashboardHotPosts = ref([]); // å¤‡ä»½ dashboard çš„ hot_posts\n\n    const normalizeHotPostsFromUniv = (list, univName) => {\n      // æŠŠ /universities/posts çš„è¿”å›ç»Ÿä¸€æˆä½ æ¨¡æ¿éœ€è¦çš„å­—æ®µ\n      return (Array.isArray(list) ? list : []).map(p => ({\n        post_id: p.id ?? p.post_id,\n        title: p.title,\n        univ_name: univName,\n        view_count: p.view_count ?? 0\n      }));\n    };\n    const pickPostList = res => {\n      // âœ… å…¼å®¹ä¸¤ç§ï¼š1) http å·²ç»è¿”å›ä¸šåŠ¡åŒ… {code,data}\n      //            2) axios åŸå§‹åŒ… {data:{code,data}}\n      const root = res && typeof res === 'object' && 'code' in res ? res : res?.data ?? res;\n      const data = root?.data ?? {};\n\n      // âœ… å¸¸è§å­—æ®µï¼šlist / posts / items / ç›´æ¥æ•°ç»„\n      const list = (Array.isArray(data) ? data : null) ?? (Array.isArray(data.list) ? data.list : null) ?? (Array.isArray(data.posts) ? data.posts : null) ?? (Array.isArray(data.items) ? data.items : null) ?? [];\n      return {\n        code: root?.code,\n        list,\n        raw: root\n      };\n    };\n    const refreshHotPosts = async () => {\n      console.log('[hotPosts] Starting refresh for:', selectedUniv.value);\n\n      // \"å…¨éƒ¨\"æ¢å¤ dashboard\n      if (!selectedUniv.value) {\n        hotPosts.value = filterPostsByFollowed(dashboardHotPosts.value);\n        console.log('[hotPosts] Restored dashboard posts:', hotPosts.value.length);\n        return;\n      }\n      const univId = univMap.value?.[selectedUniv.value]?.univId ?? allUnivs.value.find(u => u.univ_name === selectedUniv.value)?.univ_id;\n      console.log('[hotPosts] Found univId:', univId, 'for', selectedUniv.value);\n      if (!univId) {\n        hotPosts.value = [];\n        console.log('[hotPosts] No univId found, clearing posts');\n        return;\n      }\n      try {\n        const res = await univPostsAPI({\n          univ_id: univId,\n          keyword: ''\n        });\n        const {\n          code,\n          list,\n          raw\n        } = pickPostList(res);\n        console.log('[hotPosts] API response - code:', code, 'list length:', list.length);\n        const sorted = [...list].sort((a, b) => (b.view_count ?? 0) - (a.view_count ?? 0));\n        hotPosts.value = normalizeHotPostsFromUniv(sorted.slice(0, 10), selectedUniv.value);\n        console.log('[hotPosts] Updated hotPosts:', hotPosts.value.length);\n      } catch (e) {\n        console.error('[hotPosts] refresh failed', e);\n        hotPosts.value = [];\n      }\n    };\n    const filterPostsByFollowed = posts => {\n      const set = new Set(followedUnivs.value);\n      return (Array.isArray(posts) ? posts : []).filter(p => {\n        const name = p.univ_name || p.university_name || p.univ || '';\n        return set.has(name);\n      });\n    };\n    const handleSelectUniv = async name => {\n      selectedUniv.value = name;\n      // ä½¿ç”¨ nextTick ç¡®ä¿ Vue å“åº”å¼ç³»ç»Ÿå·²æ›´æ–°\n      await nextTick();\n      await refreshHotPosts();\n    };\n    onMounted(async () => {\n      checkScreenSize();\n      window.addEventListener('resize', checkScreenSize);\n      const user = JSON.parse(localStorage.getItem('user_info') || '{}');\n      nickname.value = user.nickname || user.username || 'åŒå­¦';\n      const rawUserId = localStorage.getItem('user_id');\n      userId.value = Number(rawUserId || user.id || 0);\n      if (!userId.value) {\n        console.warn('[home] userId invalid');\n        showToast('ç”¨æˆ·ä¿¡æ¯æ— æ•ˆ', 'error');\n        return;\n      }\n      try {\n        // å…ˆåŠ è½½æ‰€æœ‰å¤§å­¦åˆ—è¡¨ï¼Œè¿™æ ·åç»­å¯ä»¥æ ¹æ® univ_id æŸ¥æ‰¾åç§°\n        await loadAllUniversities();\n\n        // ç„¶åå¹¶è¡Œè¯·æ±‚ dashboard å’Œå…³æ³¨åˆ—è¡¨\n        const [dashboardRes, followsRes] = await Promise.all([dashboardAPI(userId.value), followListAPI(userId.value)]);\n\n        // å¤„ç† dashboard æ•°æ®\n        const data = dashboardRes?.data ?? {};\n        quote.value = data.quote || '';\n        bgImageUrl.value = toStaticUrl(data.bg_image);\n        ddlReminders.value = Array.isArray(data.ddl_reminders) ? data.ddl_reminders : [];\n        dashboardHotPosts.value = Array.isArray(data.hot_posts) ? data.hot_posts : [];\n        hotPosts.value = dashboardHotPosts.value;\n\n        // å¦‚æœ allUnivs ä¸ºç©ºï¼Œå°è¯•ä» ddlReminders æ„å»ºï¼ˆå…œåº•ï¼‰\n        if (allUnivs.value.length === 0) {\n          const univSet = new Map();\n          ddlReminders.value.forEach(item => {\n            if (item?.univ_name && item?.univ_id) {\n              univSet.set(item.univ_name, {\n                univ_name: item.univ_name,\n                univ_id: item.univ_id\n              });\n            }\n          });\n          allUnivs.value = Array.from(univSet.values());\n        }\n        console.log('[Debug] Available universities:', allUnivs.value);\n\n        // å¤„ç†å…³æ³¨åˆ—è¡¨\n        if (followsRes?.code === 200 && Array.isArray(followsRes.data)) {\n          univMap.value = {};\n          followedUnivs.value = [];\n          followsRes.data.forEach(item => {\n            // å¦‚æœåç«¯è¿”å›äº† univ_nameï¼Œç›´æ¥ä½¿ç”¨\n            let univName = item.univ_name;\n\n            // å¦‚æœæ²¡æœ‰ univ_nameï¼Œä» allUnivs ä¸­æŸ¥æ‰¾\n            if (!univName && item.univ_id) {\n              const univ = allUnivs.value.find(u => u.univ_id === item.univ_id);\n              univName = univ?.univ_name;\n            }\n            if (univName) {\n              followedUnivs.value.push(univName);\n              univMap.value[univName] = {\n                followId: item.id,\n                univId: item.univ_id\n              };\n            } else {\n              console.warn('[Debug] Cannot find univ_name for:', item);\n            }\n          });\n          console.log('[Debug] Initial follows:', followedUnivs.value);\n          console.log('[Debug] Initial univMap:', univMap.value);\n\n          // åŠ è½½æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥\n          if (followedUnivs.value.length > 0) {\n            await loadAllFollowedNotices();\n          }\n        }\n      } catch (e) {\n        console.error('[home] API failed', e);\n        showToast('æ•°æ®åŠ è½½å¤±è´¥', 'error');\n      }\n    });\n    onUnmounted(() => {\n      window.removeEventListener('resize', checkScreenSize);\n    });\n    return {\n      quote,\n      quoteText,\n      quoteAuthor,\n      bgImageUrl,\n      ddlReminders,\n      hotPosts,\n      nickname,\n      currentDay,\n      daysInMonth,\n      dayOfWeek,\n      isMobileView,\n      selectedUniv,\n      followedUnivs,\n      availableUnivs,\n      allUnivs,\n      filteredDdlReminders,\n      showAddModal,\n      isLoading,\n      toast,\n      searchKeyword,\n      selectedRegion,\n      availableRegions,\n      filteredUnivs,\n      handleToggleFollow,\n      handleRemoveFollow,\n      openNoticeLink,\n      openAddModal,\n      getDaysLeft,\n      countdownText,\n      hasPast,\n      handleSelectUniv,\n      goPostDetail\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","nextTick","useRouter","themeEventBus","dashboardAPI","followListAPI","followAddAPI","followDeleteAPI","universitiesAPI","univNoticesAPI","univPostsAPI","name","setup","quote","bgImageUrl","ddlReminders","hotPosts","nickname","currentDate","Date","isMobileView","userId","followedUnivs","selectedUniv","showAddModal","isLoading","searchKeyword","selectedRegion","univMap","router","goPostDetail","postId","push","path","toast","show","message","type","showToast","value","setTimeout","currentDay","getDate","daysInMonth","getFullYear","getMonth","dayOfWeek","days","getDay","quoteText","raw","trim","textPart","split","replace","quoteAuthor","parts","length","slice","join","allUnivs","allNotices","refreshTrigger","availableUnivs","map","u","univ_name","sort","set","Set","forEach","item","add","Array","from","availableRegions","regions","match","filteredUnivs","list","filter","startsWith","keyword","toLowerCase","includes","filteredDdlReminders","_","mergedList","console","log","merged","uniqueMap","Map","id","notice_id","key","has","values","included","mapped","it","_days","getDaysLeft","_past","hasPast","a","b","checkScreenSize","window","innerWidth","toStaticUrl","p","parseDate","s","str","String","replaceAll","BASE_DATE","calcDaysLeft","endDateStr","end","isNaN","getTime","diff","Math","ceil","end_date","days_left","max","countdownText","d","openNoticeLink","source_link","url","open","resetModalFilters","openAddModal","loadFollowedUnivs","res","code","isArray","data","univName","univ_id","univ","find","followId","univId","warn","e","error","loadAllUniversities","page","size","logo_url","tags","intro","loadUnivNotices","noticesData","notices","notice","loadAllFollowedNotices","noticesPromises","univInfo","noticesArrays","Promise","all","flat","handleToggleFollow","isFollowed","handleRemoveFollow","handleAddFollow","user_id","refreshHotPosts","msg","index","indexOf","splice","beforeCount","afterCount","dashboardHotPosts","normalizeHotPostsFromUniv","post_id","title","view_count","pickPostList","root","posts","items","filterPostsByFollowed","sorted","university_name","handleSelectUniv","addEventListener","user","JSON","parse","localStorage","getItem","username","rawUserId","Number","dashboardRes","followsRes","bg_image","ddl_reminders","hot_posts","univSet","removeEventListener"],"sources":["D:\\Projects\\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\\frontend\\src\\views\\home.vue"],"sourcesContent":["<template>\r\n    <div class=\"responsive-layout\" :class=\"{ 'mobile-layout': isMobileView }\">\r\n        <!-- Daily Card Section -->\r\n        <div class=\"section-container left-pane\">\r\n            <h2 class=\"section-title\">æ¬¢è¿{{ nickname }}ï¼</h2>\r\n            <div class=\"daily-card\">\r\n                <div class=\"card-image\">\r\n                    <img\r\n                        :src=\"bgImageUrl || '/images/bgi.jpg'\"\r\n                        alt=\"Daily inspiration\"\r\n                    />\r\n                </div>\r\n                <div class=\"card-content\">\r\n                    <p class=\"quote-text\" v-text=\"quoteText\"></p>\r\n                    <p class=\"quote-author\" v-if=\"quoteAuthor\">\r\n                        â€”â€”{{ quoteAuthor }}\r\n                    </p>\r\n                </div>\r\n                <div class=\"card-footer\">\r\n                    <div class=\"service-info\">@samhan</div>\r\n                    <div class=\"date-box\">\r\n                        <div class=\"date\">\r\n                            {{ currentDay }}/{{ daysInMonth }}\r\n                        </div>\r\n                        <div class=\"day\">{{ dayOfWeek }}.</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Section two -->\r\n        <div class=\"section-container right-pane\">\r\n            <div class=\"info-grid\">\r\n                <!-- æˆ‘çš„å…³æ³¨ -->\r\n                <div class=\"info-card\">\r\n                    <div class=\"card-header\">\r\n                        <h3 class=\"card-title\">\r\n                            <span class=\"star-icon\">â­</span>\r\n                            æˆ‘çš„å…³æ³¨\r\n                        </h3>\r\n                        <button class=\"add-btn\" @click=\"openAddModal\">\r\n                            + æ·»åŠ å…³æ³¨\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div class=\"tags-container\">\r\n                        <span\r\n                            class=\"tag\"\r\n                            :class=\"{ active: selectedUniv === '' }\"\r\n                            @click=\"handleSelectUniv('')\"\r\n                        >\r\n                            å…¨éƒ¨\r\n                        </span>\r\n\r\n                        <span\r\n                            class=\"tag\"\r\n                            v-for=\"u in followedUnivs\"\r\n                            :key=\"u\"\r\n                            :class=\"{ active: selectedUniv === u }\"\r\n                            @click=\"handleSelectUniv(u)\"\r\n                        >\r\n                            {{ u }}\r\n                            <span\r\n                                class=\"tag-close\"\r\n                                @click.stop=\"handleRemoveFollow(u)\"\r\n                                >Ã—</span\r\n                            >\r\n                        </span>\r\n                    </div>\r\n\r\n                    <div class=\"ddl-section\">\r\n                        <div class=\"section-header\">\r\n                            <span class=\"section-label\">ä¸´è¿‘ DDL æé†’</span>\r\n                            <span class=\"from-label\">æ¥è‡ªå…³æ³¨åˆ—è¡¨</span>\r\n                        </div>\r\n\r\n                        <div\r\n                            v-if=\"filteredDdlReminders.length === 0\"\r\n                            class=\"empty-message\"\r\n                        >\r\n                            {{\r\n                                selectedUniv\r\n                                    ? `${selectedUniv} æš‚æ— DDLæé†’`\r\n                                    : 'æš‚æ— DDLæé†’ï¼Œè¯·æ·»åŠ å…³æ³¨'\r\n                            }}\r\n                        </div>\r\n\r\n                        <div\r\n                            class=\"ddl-item\"\r\n                            v-for=\"item in filteredDdlReminders\"\r\n                            :key=\"item.notice_id || item.id\"\r\n                            @click=\"openNoticeLink(item)\"\r\n                        >\r\n                            <div class=\"ddl-info\">\r\n                                <div class=\"ddl-title\">\r\n                                    {{ item.univ_name }} - {{ item.dept_name }}\r\n                                </div>\r\n                                <div class=\"ddl-subtitle\">{{ item.title }}</div>\r\n                                <div class=\"ddl-deadline\">\r\n                                    æˆªæ­¢: {{ item.end_date || 'æš‚æ— ' }}\r\n                                </div>\r\n                            </div>\r\n                            <div\r\n                                class=\"ddl-countdown\"\r\n                                :class=\"{ expired: hasPast(item) }\"\r\n                            >\r\n                                {{ countdownText(item) }}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- çƒ­é—¨å¸–å­æ¨è -->\r\n                <div class=\"info-card\">\r\n                    <div class=\"card-header\">\r\n                        <h3 class=\"card-title\">çƒ­é—¨å¸–å­æ¨è</h3>\r\n                        <span class=\"top-label\">TOP</span>\r\n                    </div>\r\n\r\n                    <div class=\"posts-list\">\r\n                        <div\r\n                            class=\"post-item\"\r\n                            v-for=\"(post, idx) in hotPosts\"\r\n                            :key=\"post.post_id\"\r\n                            @click=\"goPostDetail(post.post_id)\"\r\n                        >\r\n                            <span class=\"post-rank\">{{ idx + 1 }}</span>\r\n                            <div class=\"post-content\">\r\n                                <div class=\"post-title\">{{ post.title }}</div>\r\n                                <div class=\"post-meta\">\r\n                                    <span class=\"post-source\">{{\r\n                                        post.univ_name\r\n                                    }}</span>\r\n                                    <span class=\"post-views\"\r\n                                        >ğŸ‘ {{ post.view_count }}</span\r\n                                    >\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- æ·»åŠ å…³æ³¨å¼¹çª— -->\r\n        <div\r\n            v-if=\"showAddModal\"\r\n            class=\"modal-overlay\"\r\n            @click=\"showAddModal = false\"\r\n        >\r\n            <div class=\"modal-content\" @click.stop>\r\n                <div class=\"modal-header\">\r\n                    <h3>é€‰æ‹©è¦å…³æ³¨çš„å¤§å­¦</h3>\r\n                    <button class=\"close-btn\" @click=\"showAddModal = false\">\r\n                        Ã—\r\n                    </button>\r\n                </div>\r\n\r\n                <!-- æœç´¢å’Œç­›é€‰åŒºåŸŸ -->\r\n                <div class=\"modal-filters\">\r\n                    <div class=\"search-box\">\r\n                        <input\r\n                            type=\"text\"\r\n                            v-model=\"searchKeyword\"\r\n                            placeholder=\"æœç´¢å¤§å­¦åç§°...\"\r\n                            class=\"search-input\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div class=\"region-filters\">\r\n                        <button\r\n                            class=\"region-btn\"\r\n                            :class=\"{ active: selectedRegion === '' }\"\r\n                            @click=\"selectedRegion = ''\"\r\n                        >\r\n                            å…¨éƒ¨åœ°åŒº\r\n                        </button>\r\n                        <button\r\n                            v-for=\"region in availableRegions\"\r\n                            :key=\"region\"\r\n                            class=\"region-btn\"\r\n                            :class=\"{ active: selectedRegion === region }\"\r\n                            @click=\"selectedRegion = region\"\r\n                        >\r\n                            {{ region }}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"modal-body\">\r\n                    <div v-if=\"isLoading\" class=\"loading-message\">\r\n                        åŠ è½½ä¸­...\r\n                    </div>\r\n                    <div\r\n                        v-else-if=\"filteredUnivs.length === 0\"\r\n                        class=\"empty-message\"\r\n                    >\r\n                        {{\r\n                            searchKeyword || selectedRegion\r\n                                ? 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¤§å­¦'\r\n                                : 'æš‚æ— å¯å…³æ³¨çš„å¤§å­¦'\r\n                        }}\r\n                    </div>\r\n                    <div v-else class=\"univ-list\">\r\n                        <label\r\n                            v-for=\"u in filteredUnivs\"\r\n                            :key=\"u\"\r\n                            class=\"univ-item\"\r\n                            :class=\"{ disabled: isLoading }\"\r\n                        >\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                :checked=\"followedUnivs.includes(u)\"\r\n                                @change=\"handleToggleFollow(u)\"\r\n                                :disabled=\"isLoading\"\r\n                            />\r\n                            <span>{{ u }}</span>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button\r\n                        class=\"btn-cancel\"\r\n                        @click=\"showAddModal = false\"\r\n                        :disabled=\"isLoading\"\r\n                    >\r\n                        å…³é—­\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Toast æç¤º -->\r\n        <div v-if=\"toast.show\" class=\"toast\" :class=\"toast.type\">\r\n            {{ toast.message }}\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted, onUnmounted, nextTick } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { themeEventBus } from '@/utils/themeEvent'\r\nimport { dashboardAPI } from '@/api/dashboard'\r\nimport { followListAPI, followAddAPI, followDeleteAPI } from '@/api/follows'\r\nimport {\r\n    universitiesAPI,\r\n    univNoticesAPI,\r\n    univPostsAPI\r\n} from '@/api/universities'\r\n\r\nexport default {\r\n    name: 'CalendarWithDailyCard',\r\n    setup() {\r\n        const quote = ref('')\r\n        const bgImageUrl = ref('')\r\n        const ddlReminders = ref([])\r\n        const hotPosts = ref([])\r\n        const nickname = ref('')\r\n        const currentDate = ref(new Date())\r\n        const isMobileView = ref(false)\r\n\r\n        const userId = ref(0)\r\n        const followedUnivs = ref([])\r\n        const selectedUniv = ref('')\r\n        const showAddModal = ref(false)\r\n        const isLoading = ref(false)\r\n\r\n        // å¼¹çª—æœç´¢å’Œç­›é€‰\r\n        const searchKeyword = ref('')\r\n        const selectedRegion = ref('')\r\n\r\n        // å­˜å‚¨ univ_name -> {followId, univId} çš„æ˜ å°„\r\n        const univMap = ref({})\r\n\r\n        const router = useRouter()\r\n\r\n        const goPostDetail = postId => {\r\n            if (!postId) return\r\n            // âœ… æŒ‰ä½ è·¯ç”±é…ç½®æ”¹ï¼šæ¯”å¦‚ /posts/detail/:id\r\n            router.push({ path: `/main/posts/detail/${postId}` })\r\n            // æˆ–è€…ï¼šrouter.push({ name: 'PostDetail', params: { id: postId } })\r\n        }\r\n\r\n        // Toast æç¤º\r\n        const toast = ref({\r\n            show: false,\r\n            message: '',\r\n            type: 'success' // success | error\r\n        })\r\n\r\n        const showToast = (message, type = 'success') => {\r\n            toast.value = { show: true, message, type }\r\n            setTimeout(() => {\r\n                toast.value.show = false\r\n            }, 3000)\r\n        }\r\n\r\n        const currentDay = computed(() => currentDate.value.getDate())\r\n        const daysInMonth = computed(() => {\r\n            return new Date(\r\n                currentDate.value.getFullYear(),\r\n                currentDate.value.getMonth() + 1,\r\n                0\r\n            ).getDate()\r\n        })\r\n        const dayOfWeek = computed(() => {\r\n            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\r\n            return days[currentDate.value.getDay()]\r\n        })\r\n\r\n        const quoteText = computed(() => {\r\n            const raw = (quote.value || '').trim()\r\n            if (!raw) return ''\r\n            const [textPart] = raw.split('##')\r\n            return (textPart || '').trim().replace(/\\\\n/g, '\\n')\r\n        })\r\n\r\n        const quoteAuthor = computed(() => {\r\n            const raw = (quote.value || '').trim()\r\n            if (!raw) return ''\r\n            const parts = raw.split('##')\r\n            if (parts.length < 2) return ''\r\n            return (parts.slice(1).join('##') || '').trim()\r\n        })\r\n\r\n        // å­˜å‚¨æ‰€æœ‰å¯ç”¨çš„å¤§å­¦ä¿¡æ¯ï¼ˆåŒ…å« univ_idï¼‰\r\n        const allUnivs = ref([])\r\n\r\n        // å­˜å‚¨æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥åˆ—è¡¨ï¼ˆåˆå¹¶åçš„ï¼‰\r\n        const allNotices = ref([])\r\n\r\n        // å¼ºåˆ¶åˆ·æ–°æ ‡è®°ï¼ˆç”¨äºè§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—ï¼‰\r\n        const refreshTrigger = ref(0)\r\n\r\n        const availableUnivs = computed(() => {\r\n            // ä¼˜å…ˆä» allUnivs è·å–\r\n            if (allUnivs.value.length > 0) {\r\n                return allUnivs.value.map(u => u.univ_name).sort()\r\n            }\r\n\r\n            // å…œåº•ï¼šä» ddlReminders ä¸­æå–\r\n            const set = new Set()\r\n            ddlReminders.value.forEach(item => {\r\n                if (item?.univ_name) set.add(item.univ_name)\r\n            })\r\n            return Array.from(set).sort()\r\n        })\r\n\r\n        // æå–æ‰€æœ‰åœ°åŒº\r\n        const availableRegions = computed(() => {\r\n            const regions = new Set()\r\n            allUnivs.value.forEach(u => {\r\n                // ä»å¤§å­¦åç§°ä¸­æå–åœ°åŒºï¼ˆå¦‚ï¼šä¸Šæµ·ã€åŒ—äº¬ã€æ±Ÿè‹ç­‰ï¼‰\r\n                const match = u.univ_name.match(\r\n                    /^(ä¸Šæµ·|åŒ—äº¬|å¤©æ´¥|é‡åº†|æ±Ÿè‹|æµ™æ±Ÿ|å¹¿ä¸œ|å››å·|æ¹–åŒ—|å±±ä¸œ|é™•è¥¿|è¾½å®|æ¹–å—|ç¦å»º|æ²³å—|æ²³åŒ—|å®‰å¾½|é»‘é¾™æ±Ÿ|å‰æ—|äº‘å—|å±±è¥¿|æ±Ÿè¥¿|è´µå·|å¹¿è¥¿|ç”˜è‚ƒ|å†…è’™å¤|æ–°ç–†|æµ·å—|å®å¤|é’æµ·|è¥¿è—|é¦™æ¸¯|æ¾³é—¨|å°æ¹¾)/\r\n                )\r\n                if (match) {\r\n                    regions.add(match[1])\r\n                }\r\n            })\r\n            return Array.from(regions).sort()\r\n        })\r\n\r\n        // è¿‡æ»¤åçš„å¤§å­¦åˆ—è¡¨\r\n        const filteredUnivs = computed(() => {\r\n            let list = allUnivs.value\r\n\r\n            // æŒ‰åœ°åŒºç­›é€‰\r\n            if (selectedRegion.value) {\r\n                list = list.filter(u =>\r\n                    u.univ_name.startsWith(selectedRegion.value)\r\n                )\r\n            }\r\n\r\n            // æŒ‰å…³é”®è¯æœç´¢\r\n            if (searchKeyword.value.trim()) {\r\n                const keyword = searchKeyword.value.trim().toLowerCase()\r\n                list = list.filter(u =>\r\n                    u.univ_name.toLowerCase().includes(keyword)\r\n                )\r\n            }\r\n\r\n            return list.map(u => u.univ_name).sort()\r\n        })\r\n\r\n        const filteredDdlReminders = computed(() => {\r\n            // ä¾èµ– refreshTrigger æ¥å¼ºåˆ¶é‡æ–°è®¡ç®—\r\n            const _ = refreshTrigger.value\r\n\r\n            // ä½¿ç”¨åˆå¹¶åçš„é€šçŸ¥åˆ—è¡¨ï¼ˆæ¥è‡ª dashboard çš„ ddlReminders + åŠ¨æ€åŠ è½½çš„ allNoticesï¼‰\r\n            const mergedList = [...ddlReminders.value, ...allNotices.value]\r\n\r\n            console.log('[Debug] Computing filteredDdlReminders:', {\r\n                refreshTrigger: refreshTrigger.value,\r\n                ddlReminders: ddlReminders.value.length,\r\n                allNotices: allNotices.value.length,\r\n                merged: mergedList.length,\r\n                followedUnivs: followedUnivs.value\r\n            })\r\n\r\n            // å»é‡ï¼šæ ¹æ® id å»é‡\r\n            const uniqueMap = new Map()\r\n            mergedList.forEach(item => {\r\n                if (item?.id || item?.notice_id) {\r\n                    const key = item.id || item.notice_id\r\n                    if (!uniqueMap.has(key)) {\r\n                        uniqueMap.set(key, item)\r\n                    }\r\n                }\r\n            })\r\n\r\n            let list = Array.from(uniqueMap.values()).filter(item => {\r\n                const included = followedUnivs.value.includes(item.univ_name)\r\n                if (!included) {\r\n                    console.log(\r\n                        '[Debug] Filtering out:',\r\n                        item.univ_name,\r\n                        'not in',\r\n                        followedUnivs.value\r\n                    )\r\n                }\r\n                return included\r\n            })\r\n\r\n            console.log('[Debug] After follow filter:', list.length)\r\n\r\n            if (selectedUniv.value) {\r\n                list = list.filter(\r\n                    item => item.univ_name === selectedUniv.value\r\n                )\r\n            }\r\n\r\n            const mapped = list.map(it => ({\r\n                ...it,\r\n                _days: getDaysLeft(it),\r\n                _past: hasPast(it)\r\n            }))\r\n\r\n            // æ’åºï¼šæœªè¿‡æœŸçš„æŒ‰å‰©ä½™å¤©æ•°å‡åºï¼Œå·²è¿‡æœŸçš„æ”¾æœ€å\r\n            mapped.sort((a, b) => {\r\n                // å¦‚æœä¸€ä¸ªè¿‡æœŸä¸€ä¸ªæ²¡è¿‡æœŸï¼Œæ²¡è¿‡æœŸçš„æ’å‰é¢\r\n                if (a._past !== b._past) {\r\n                    return a._past ? 1 : -1\r\n                }\r\n\r\n                // éƒ½æœªè¿‡æœŸæˆ–éƒ½è¿‡æœŸï¼ŒæŒ‰å¤©æ•°æ’åº\r\n                if (a._days === '--' && b._days === '--') return 0\r\n                if (a._days === '--') return 1\r\n                if (b._days === '--') return -1\r\n                return a._days - b._days\r\n            })\r\n\r\n            console.log('[Debug] Final filtered list:', mapped.length)\r\n\r\n            return mapped\r\n        })\r\n\r\n        const checkScreenSize = () => {\r\n            isMobileView.value = window.innerWidth < 1200\r\n        }\r\n\r\n        const toStaticUrl = p => {\r\n            if (!p) return ''\r\n            if (p.startsWith('http')) return p\r\n            if (p.startsWith('/static')) return p\r\n            return '/static/' + p.replace(/^\\/+/, '')\r\n        }\r\n\r\n        const parseDate = s => {\r\n            if (!s) return null\r\n            if (typeof s === 'number') return new Date(s)\r\n            const str = String(s).trim()\r\n            if (str.includes(' ')) return new Date(str.replace(' ', 'T'))\r\n            if (str.includes('/')) return new Date(str.replaceAll('/', '-'))\r\n            return new Date(str + 'T23:59:59')\r\n        }\r\n\r\n        // âœ… å›ºå®šèµ·ç‚¹ï¼š2025-01-01\r\n        const BASE_DATE = new Date('2025-01-01T00:00:00')\r\n\r\n        const calcDaysLeft = endDateStr => {\r\n            const end = parseDate(endDateStr)\r\n            if (!end || isNaN(end.getTime())) return '--'\r\n\r\n            // âœ… ä»å›ºå®šèµ·ç‚¹ç®—ï¼ˆè€Œä¸æ˜¯ä»ä»Šå¤©ç®—ï¼‰\r\n            const diff = end.getTime() - BASE_DATE.getTime()\r\n            return diff <= 0 ? 0 : Math.ceil(diff / (1000 * 60 * 60 * 24))\r\n        }\r\n\r\n        const hasPast = item => {\r\n            if (item?.end_date) {\r\n                const end = parseDate(item.end_date)\r\n                if (!end || isNaN(end.getTime())) return false\r\n\r\n                // âœ… æ˜¯å¦\"æ—©äºå›ºå®šèµ·ç‚¹\"\r\n                return end.getTime() < BASE_DATE.getTime()\r\n            }\r\n            return typeof item?.days_left === 'number' && item.days_left < 0\r\n        }\r\n\r\n        const getDaysLeft = item => {\r\n            if (item?.end_date) return calcDaysLeft(item.end_date)\r\n            if (typeof item?.days_left === 'number')\r\n                return Math.max(0, item.days_left)\r\n            return '--'\r\n        }\r\n\r\n        const countdownText = item => {\r\n            const d = getDaysLeft(item)\r\n            if (d === '--') return 'æˆªæ­¢æœªçŸ¥'\r\n            if (hasPast(item) || d === 0) return 'å·²æˆªæ­¢'\r\n            return `å‰© ${d} å¤©`\r\n        }\r\n\r\n        // æ‰“å¼€é€šçŸ¥é“¾æ¥\r\n        const openNoticeLink = item => {\r\n            if (item?.source_link) {\r\n                // ç¡®ä¿é“¾æ¥æœ‰åè®®å‰ç¼€\r\n                let url = item.source_link\r\n                if (!url.startsWith('http://') && !url.startsWith('https://')) {\r\n                    url = 'https://' + url\r\n                }\r\n                window.open(url, '_blank')\r\n            }\r\n        }\r\n\r\n        // é‡ç½®å¼¹çª—æœç´¢ç­›é€‰\r\n        const resetModalFilters = () => {\r\n            searchKeyword.value = ''\r\n            selectedRegion.value = ''\r\n        }\r\n\r\n        // æ‰“å¼€å¼¹çª—æ—¶é‡ç½®ç­›é€‰\r\n        const openAddModal = () => {\r\n            resetModalFilters()\r\n            showAddModal.value = true\r\n        }\r\n\r\n        // ä»åç«¯åŠ è½½å…³æ³¨åˆ—è¡¨\r\n        const loadFollowedUnivs = async () => {\r\n            try {\r\n                const res = await followListAPI(userId.value)\r\n                console.log('[Debug] followListAPI response:', res)\r\n\r\n                if (res?.code === 200 && Array.isArray(res.data)) {\r\n                    // æ„å»ºæ˜ å°„è¡¨\r\n                    univMap.value = {}\r\n                    followedUnivs.value = []\r\n\r\n                    res.data.forEach(item => {\r\n                        // å¦‚æœåç«¯è¿”å›äº† univ_nameï¼Œç›´æ¥ä½¿ç”¨\r\n                        let univName = item.univ_name\r\n\r\n                        // å¦‚æœæ²¡æœ‰ univ_nameï¼Œä» allUnivs ä¸­æŸ¥æ‰¾\r\n                        if (!univName && item.univ_id) {\r\n                            const univ = allUnivs.value.find(\r\n                                u => u.univ_id === item.univ_id\r\n                            )\r\n                            univName = univ?.univ_name\r\n                        }\r\n\r\n                        if (univName) {\r\n                            followedUnivs.value.push(univName)\r\n                            univMap.value[univName] = {\r\n                                followId: item.id,\r\n                                univId: item.univ_id\r\n                            }\r\n                        } else {\r\n                            console.warn(\r\n                                '[Debug] Cannot find univ_name for:',\r\n                                item\r\n                            )\r\n                        }\r\n                    })\r\n\r\n                    console.log('[Debug] Loaded follows:', followedUnivs.value)\r\n                    console.log('[Debug] UnivMap:', univMap.value)\r\n                }\r\n            } catch (e) {\r\n                console.error('Failed to load followed univs:', e)\r\n                showToast('åŠ è½½å…³æ³¨åˆ—è¡¨å¤±è´¥', 'error')\r\n            }\r\n        }\r\n\r\n        // åŠ è½½æ‰€æœ‰å¯ç”¨çš„å¤§å­¦åˆ—è¡¨\r\n        const loadAllUniversities = async () => {\r\n            try {\r\n                // è·å–æ‰€æœ‰å¤§å­¦ï¼ˆä¸åˆ†é¡µï¼Œè®¾ç½®è¾ƒå¤§çš„ sizeï¼‰\r\n                const res = await universitiesAPI({ page: 1, size: 1000 })\r\n                if (res?.code === 200 && res?.data?.list) {\r\n                    allUnivs.value = res.data.list.map(u => ({\r\n                        univ_id: u.id,\r\n                        univ_name: u.name,\r\n                        logo_url: u.logo_url,\r\n                        tags: u.tags,\r\n                        intro: u.intro\r\n                    }))\r\n                    console.log(\r\n                        '[Debug] Loaded universities:',\r\n                        allUnivs.value.length\r\n                    )\r\n                }\r\n            } catch (e) {\r\n                console.error('Failed to load universities:', e)\r\n            }\r\n        }\r\n\r\n        // åŠ è½½æŸä¸ªå¤§å­¦çš„é€šçŸ¥åˆ—è¡¨\r\n        const loadUnivNotices = async (univId, univName) => {\r\n            try {\r\n                console.log('[Debug] Loading notices for:', {\r\n                    univId,\r\n                    univName\r\n                })\r\n                const res = await univNoticesAPI(univId)\r\n                console.log('[Debug] univNoticesAPI response:', res)\r\n\r\n                if (res?.code === 200) {\r\n                    // åç«¯è¿”å›çš„ç»“æ„æ˜¯ {code: 200, data: {info: {...}, notices: [...]}}\r\n                    const noticesData = res.data?.notices || res.data\r\n\r\n                    if (Array.isArray(noticesData)) {\r\n                        // ç»™æ¯ä¸ªé€šçŸ¥æ·»åŠ  univ_name å’Œ univ_id\r\n                        const notices = noticesData.map(notice => ({\r\n                            ...notice,\r\n                            id: notice.id, // ä¿ç•™åŸå§‹ id\r\n                            notice_id: notice.id, // æ·»åŠ  notice_id ç”¨äºå»é‡\r\n                            univ_id: univId,\r\n                            univ_name: univName\r\n                        }))\r\n                        console.log('[Debug] Processed notices:', notices)\r\n                        return notices\r\n                    }\r\n                }\r\n            } catch (e) {\r\n                console.error('Failed to load notices for', univName, e)\r\n            }\r\n            return []\r\n        }\r\n\r\n        // æ‰¹é‡åŠ è½½æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥\r\n        const loadAllFollowedNotices = async () => {\r\n            console.log(\r\n                '[Debug] Loading all followed notices for:',\r\n                followedUnivs.value\r\n            )\r\n            const noticesPromises = []\r\n\r\n            for (const univName of followedUnivs.value) {\r\n                const univInfo = univMap.value[univName]\r\n                if (univInfo?.univId) {\r\n                    noticesPromises.push(\r\n                        loadUnivNotices(univInfo.univId, univName)\r\n                    )\r\n                } else {\r\n                    console.warn('[Debug] No univId found for:', univName)\r\n                }\r\n            }\r\n\r\n            const noticesArrays = await Promise.all(noticesPromises)\r\n            // åˆå¹¶æ‰€æœ‰é€šçŸ¥\r\n            allNotices.value = noticesArrays.flat()\r\n            console.log(\r\n                '[Debug] Total notices loaded:',\r\n                allNotices.value.length\r\n            )\r\n            console.log('[Debug] All loaded notices:', allNotices.value)\r\n        }\r\n\r\n        // åˆ‡æ¢å…³æ³¨çŠ¶æ€\r\n        const handleToggleFollow = async univName => {\r\n            if (isLoading.value) return\r\n\r\n            const isFollowed = followedUnivs.value.includes(univName)\r\n\r\n            console.log('[Debug] Toggle follow:', { univName, isFollowed })\r\n\r\n            if (isFollowed) {\r\n                await handleRemoveFollow(univName)\r\n            } else {\r\n                await handleAddFollow(univName)\r\n            }\r\n        }\r\n\r\n        // æ·»åŠ å…³æ³¨\r\n        const handleAddFollow = async univName => {\r\n            if (isLoading.value) return\r\n\r\n            // æ£€æŸ¥æ˜¯å¦å·²ç»å…³æ³¨\r\n            if (followedUnivs.value.includes(univName)) {\r\n                console.log('[Debug] Already followed:', univName)\r\n                return // ä¸æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œé™é»˜è¿”å›\r\n            }\r\n\r\n            // ä¼˜å…ˆä» allUnivs ä¸­æŸ¥æ‰¾\r\n            let univInfo = allUnivs.value.find(u => u.univ_name === univName)\r\n\r\n            // å…œåº•ï¼šä» ddlReminders ä¸­æŸ¥æ‰¾\r\n            if (!univInfo) {\r\n                univInfo = ddlReminders.value.find(\r\n                    item => item.univ_name === univName\r\n                )\r\n            }\r\n\r\n            if (!univInfo?.univ_id) {\r\n                console.error('Cannot find univ_id for:', univName)\r\n                showToast('æ— æ³•æ‰¾åˆ°è¯¥å¤§å­¦ä¿¡æ¯', 'error')\r\n                return\r\n            }\r\n\r\n            isLoading.value = true\r\n            try {\r\n                console.log('[Debug] Adding follow:', {\r\n                    univName,\r\n                    univ_id: univInfo.univ_id\r\n                })\r\n\r\n                const res = await followAddAPI({\r\n                    user_id: userId.value,\r\n                    univ_id: univInfo.univ_id\r\n                })\r\n\r\n                console.log('[Debug] Add follow response:', res)\r\n\r\n                if (res?.code === 200) {\r\n                    // åç«¯è¿”å›çš„ data æ˜¯ follow_id\r\n                    const followId = res.data\r\n\r\n                    // ç¡®ä¿ä¸é‡å¤æ·»åŠ \r\n                    if (!followedUnivs.value.includes(univName)) {\r\n                        followedUnivs.value = [...followedUnivs.value, univName]\r\n                        console.log(\r\n                            '[Debug] Added to followedUnivs:',\r\n                            followedUnivs.value\r\n                        )\r\n                    }\r\n\r\n                    univMap.value = {\r\n                        ...univMap.value,\r\n                        [univName]: {\r\n                            followId: followId,\r\n                            univId: univInfo.univ_id\r\n                        }\r\n                    }\r\n\r\n                    console.log('[Debug] Updated univMap:', univMap.value)\r\n\r\n                    // ç«‹å³åŠ è½½è¯¥å¤§å­¦çš„é€šçŸ¥åˆ—è¡¨\r\n                    console.log(\r\n                        '[Debug] Starting to load notices for:',\r\n                        univName\r\n                    )\r\n                    const notices = await loadUnivNotices(\r\n                        univInfo.univ_id,\r\n                        univName\r\n                    )\r\n                    console.log(\r\n                        '[Debug] Loaded notices count:',\r\n                        notices?.length || 0\r\n                    )\r\n\r\n                    if (notices && notices.length > 0) {\r\n                        // ä½¿ç”¨ Vue çš„å“åº”å¼æ›´æ–°æ–¹å¼\r\n                        allNotices.value = [...allNotices.value, ...notices]\r\n                        console.log(\r\n                            '[Debug] Total allNotices after add:',\r\n                            allNotices.value.length\r\n                        )\r\n\r\n                        // å¼ºåˆ¶è§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—\r\n                        refreshTrigger.value++\r\n                        console.log(\r\n                            '[Debug] Triggered refresh:',\r\n                            refreshTrigger.value\r\n                        )\r\n\r\n                        // ç­‰å¾… Vue æ›´æ–° DOM\r\n                        await nextTick()\r\n                        console.log(\r\n                            '[Debug] After nextTick, filteredDdlReminders count:',\r\n                            filteredDdlReminders.value.length\r\n                        )\r\n                    } else {\r\n                        console.warn('[Debug] No notices loaded for', univName)\r\n                    }\r\n\r\n                    await nextTick()\r\n                    await refreshHotPosts()\r\n\r\n                    showToast('å…³æ³¨æˆåŠŸ', 'success')\r\n                } else {\r\n                    showToast(res?.msg || 'å…³æ³¨å¤±è´¥', 'error')\r\n                }\r\n            } catch (e) {\r\n                console.error('Failed to add follow:', e)\r\n                // å¦‚æœæ˜¯é‡å¤å…³æ³¨é”™è¯¯ï¼Œç»™å‡ºæ›´å‹å¥½çš„æç¤º\r\n                if (e?.message?.includes('Duplicate')) {\r\n                    console.log(\r\n                        '[Debug] Duplicate follow detected, reloading follows'\r\n                    )\r\n                    // é‡æ–°åŒæ­¥å…³æ³¨åˆ—è¡¨\r\n                    await loadFollowedUnivs()\r\n                } else {\r\n                    showToast('å…³æ³¨å¤±è´¥ï¼Œè¯·é‡è¯•', 'error')\r\n                }\r\n            } finally {\r\n                isLoading.value = false\r\n            }\r\n        }\r\n\r\n        // å–æ¶ˆå…³æ³¨\r\n        const handleRemoveFollow = async univName => {\r\n            if (isLoading.value) return\r\n\r\n            const univInfo = univMap.value[univName]\r\n            if (!univInfo?.followId) {\r\n                console.error('Cannot find follow_id for:', univName)\r\n                console.log('[Debug] Current univMap:', univMap.value)\r\n                showToast('æ— æ³•æ‰¾åˆ°å…³æ³¨è®°å½•', 'error')\r\n                return\r\n            }\r\n\r\n            isLoading.value = true\r\n            try {\r\n                console.log('[Debug] Removing follow:', {\r\n                    univName,\r\n                    followId: univInfo.followId\r\n                })\r\n\r\n                const res = await followDeleteAPI(univInfo.followId)\r\n\r\n                console.log('[Debug] Remove follow response:', res)\r\n\r\n                if (res?.code === 200) {\r\n                    // ä»æœ¬åœ°æ•°ç»„ä¸­ç§»é™¤\r\n                    const index = followedUnivs.value.indexOf(univName)\r\n                    if (index > -1) {\r\n                        followedUnivs.value.splice(index, 1)\r\n                    }\r\n\r\n                    const univId = univMap.value[univName]?.univId\r\n                    delete univMap.value[univName]\r\n\r\n                    // åˆ é™¤è¯¥å¤§å­¦çš„æ‰€æœ‰é€šçŸ¥\r\n                    if (univId) {\r\n                        const beforeCount = allNotices.value.length\r\n                        allNotices.value = allNotices.value.filter(\r\n                            notice => notice.univ_id !== univId\r\n                        )\r\n                        const afterCount = allNotices.value.length\r\n                        console.log(\r\n                            '[Debug] Removed notices:',\r\n                            beforeCount - afterCount\r\n                        )\r\n\r\n                        // å¼ºåˆ¶è§¦å‘è®¡ç®—å±æ€§é‡æ–°è®¡ç®—\r\n                        refreshTrigger.value++\r\n                    }\r\n\r\n                    // å¦‚æœå½“å‰é€‰ä¸­çš„æ˜¯è¢«åˆ é™¤çš„å­¦æ ¡ï¼Œæ¸…ç©ºé€‰ä¸­\r\n                    if (selectedUniv.value === univName) {\r\n                        selectedUniv.value = ''\r\n                    }\r\n                    await nextTick()\r\n                    await refreshHotPosts()\r\n\r\n                    showToast('å·²å–æ¶ˆå…³æ³¨', 'success')\r\n                } else {\r\n                    showToast(res?.msg || 'å–æ¶ˆå…³æ³¨å¤±è´¥', 'error')\r\n                }\r\n            } catch (e) {\r\n                console.error('Failed to remove follow:', e)\r\n                showToast('å–æ¶ˆå…³æ³¨å¤±è´¥ï¼Œè¯·é‡è¯•', 'error')\r\n            } finally {\r\n                isLoading.value = false\r\n            }\r\n        }\r\n\r\n        const dashboardHotPosts = ref([]) // å¤‡ä»½ dashboard çš„ hot_posts\r\n\r\n        const normalizeHotPostsFromUniv = (list, univName) => {\r\n            // æŠŠ /universities/posts çš„è¿”å›ç»Ÿä¸€æˆä½ æ¨¡æ¿éœ€è¦çš„å­—æ®µ\r\n            return (Array.isArray(list) ? list : []).map(p => ({\r\n                post_id: p.id ?? p.post_id,\r\n                title: p.title,\r\n                univ_name: univName,\r\n                view_count: p.view_count ?? 0\r\n            }))\r\n        }\r\n\r\n        const pickPostList = res => {\r\n            // âœ… å…¼å®¹ä¸¤ç§ï¼š1) http å·²ç»è¿”å›ä¸šåŠ¡åŒ… {code,data}\r\n            //            2) axios åŸå§‹åŒ… {data:{code,data}}\r\n            const root =\r\n                res && typeof res === 'object' && 'code' in res\r\n                    ? res\r\n                    : res?.data ?? res\r\n\r\n            const data = root?.data ?? {}\r\n\r\n            // âœ… å¸¸è§å­—æ®µï¼šlist / posts / items / ç›´æ¥æ•°ç»„\r\n            const list =\r\n                (Array.isArray(data) ? data : null) ??\r\n                (Array.isArray(data.list) ? data.list : null) ??\r\n                (Array.isArray(data.posts) ? data.posts : null) ??\r\n                (Array.isArray(data.items) ? data.items : null) ??\r\n                []\r\n\r\n            return { code: root?.code, list, raw: root }\r\n        }\r\n\r\n        const refreshHotPosts = async () => {\r\n            console.log('[hotPosts] Starting refresh for:', selectedUniv.value)\r\n\r\n            // \"å…¨éƒ¨\"æ¢å¤ dashboard\r\n            if (!selectedUniv.value) {\r\n                hotPosts.value = filterPostsByFollowed(dashboardHotPosts.value)\r\n                console.log(\r\n                    '[hotPosts] Restored dashboard posts:',\r\n                    hotPosts.value.length\r\n                )\r\n                return\r\n            }\r\n\r\n            const univId =\r\n                univMap.value?.[selectedUniv.value]?.univId ??\r\n                allUnivs.value.find(u => u.univ_name === selectedUniv.value)\r\n                    ?.univ_id\r\n\r\n            console.log(\r\n                '[hotPosts] Found univId:',\r\n                univId,\r\n                'for',\r\n                selectedUniv.value\r\n            )\r\n\r\n            if (!univId) {\r\n                hotPosts.value = []\r\n                console.log('[hotPosts] No univId found, clearing posts')\r\n                return\r\n            }\r\n\r\n            try {\r\n                const res = await univPostsAPI({ univ_id: univId, keyword: '' })\r\n                const { code, list, raw } = pickPostList(res)\r\n\r\n                console.log(\r\n                    '[hotPosts] API response - code:',\r\n                    code,\r\n                    'list length:',\r\n                    list.length\r\n                )\r\n\r\n                const sorted = [...list].sort(\r\n                    (a, b) => (b.view_count ?? 0) - (a.view_count ?? 0)\r\n                )\r\n\r\n                hotPosts.value = normalizeHotPostsFromUniv(\r\n                    sorted.slice(0, 10),\r\n                    selectedUniv.value\r\n                )\r\n\r\n                console.log(\r\n                    '[hotPosts] Updated hotPosts:',\r\n                    hotPosts.value.length\r\n                )\r\n            } catch (e) {\r\n                console.error('[hotPosts] refresh failed', e)\r\n                hotPosts.value = []\r\n            }\r\n        }\r\n\r\n        const filterPostsByFollowed = posts => {\r\n            const set = new Set(followedUnivs.value)\r\n            return (Array.isArray(posts) ? posts : []).filter(p => {\r\n                const name = p.univ_name || p.university_name || p.univ || ''\r\n                return set.has(name)\r\n            })\r\n        }\r\n\r\n        const handleSelectUniv = async name => {\r\n            selectedUniv.value = name\r\n            // ä½¿ç”¨ nextTick ç¡®ä¿ Vue å“åº”å¼ç³»ç»Ÿå·²æ›´æ–°\r\n            await nextTick()\r\n            await refreshHotPosts()\r\n        }\r\n\r\n        onMounted(async () => {\r\n            checkScreenSize()\r\n            window.addEventListener('resize', checkScreenSize)\r\n\r\n            const user = JSON.parse(localStorage.getItem('user_info') || '{}')\r\n            nickname.value = user.nickname || user.username || 'åŒå­¦'\r\n\r\n            const rawUserId = localStorage.getItem('user_id')\r\n            userId.value = Number(rawUserId || user.id || 0)\r\n\r\n            if (!userId.value) {\r\n                console.warn('[home] userId invalid')\r\n                showToast('ç”¨æˆ·ä¿¡æ¯æ— æ•ˆ', 'error')\r\n                return\r\n            }\r\n\r\n            try {\r\n                // å…ˆåŠ è½½æ‰€æœ‰å¤§å­¦åˆ—è¡¨ï¼Œè¿™æ ·åç»­å¯ä»¥æ ¹æ® univ_id æŸ¥æ‰¾åç§°\r\n                await loadAllUniversities()\r\n\r\n                // ç„¶åå¹¶è¡Œè¯·æ±‚ dashboard å’Œå…³æ³¨åˆ—è¡¨\r\n                const [dashboardRes, followsRes] = await Promise.all([\r\n                    dashboardAPI(userId.value),\r\n                    followListAPI(userId.value)\r\n                ])\r\n\r\n                // å¤„ç† dashboard æ•°æ®\r\n                const data = dashboardRes?.data ?? {}\r\n                quote.value = data.quote || ''\r\n                bgImageUrl.value = toStaticUrl(data.bg_image)\r\n                ddlReminders.value = Array.isArray(data.ddl_reminders)\r\n                    ? data.ddl_reminders\r\n                    : []\r\n                dashboardHotPosts.value = Array.isArray(data.hot_posts)\r\n                    ? data.hot_posts\r\n                    : []\r\n                hotPosts.value = dashboardHotPosts.value\r\n\r\n                // å¦‚æœ allUnivs ä¸ºç©ºï¼Œå°è¯•ä» ddlReminders æ„å»ºï¼ˆå…œåº•ï¼‰\r\n                if (allUnivs.value.length === 0) {\r\n                    const univSet = new Map()\r\n                    ddlReminders.value.forEach(item => {\r\n                        if (item?.univ_name && item?.univ_id) {\r\n                            univSet.set(item.univ_name, {\r\n                                univ_name: item.univ_name,\r\n                                univ_id: item.univ_id\r\n                            })\r\n                        }\r\n                    })\r\n                    allUnivs.value = Array.from(univSet.values())\r\n                }\r\n\r\n                console.log('[Debug] Available universities:', allUnivs.value)\r\n\r\n                // å¤„ç†å…³æ³¨åˆ—è¡¨\r\n                if (\r\n                    followsRes?.code === 200 &&\r\n                    Array.isArray(followsRes.data)\r\n                ) {\r\n                    univMap.value = {}\r\n                    followedUnivs.value = []\r\n\r\n                    followsRes.data.forEach(item => {\r\n                        // å¦‚æœåç«¯è¿”å›äº† univ_nameï¼Œç›´æ¥ä½¿ç”¨\r\n                        let univName = item.univ_name\r\n\r\n                        // å¦‚æœæ²¡æœ‰ univ_nameï¼Œä» allUnivs ä¸­æŸ¥æ‰¾\r\n                        if (!univName && item.univ_id) {\r\n                            const univ = allUnivs.value.find(\r\n                                u => u.univ_id === item.univ_id\r\n                            )\r\n                            univName = univ?.univ_name\r\n                        }\r\n\r\n                        if (univName) {\r\n                            followedUnivs.value.push(univName)\r\n                            univMap.value[univName] = {\r\n                                followId: item.id,\r\n                                univId: item.univ_id\r\n                            }\r\n                        } else {\r\n                            console.warn(\r\n                                '[Debug] Cannot find univ_name for:',\r\n                                item\r\n                            )\r\n                        }\r\n                    })\r\n\r\n                    console.log('[Debug] Initial follows:', followedUnivs.value)\r\n                    console.log('[Debug] Initial univMap:', univMap.value)\r\n\r\n                    // åŠ è½½æ‰€æœ‰å…³æ³¨å¤§å­¦çš„é€šçŸ¥\r\n                    if (followedUnivs.value.length > 0) {\r\n                        await loadAllFollowedNotices()\r\n                    }\r\n                }\r\n            } catch (e) {\r\n                console.error('[home] API failed', e)\r\n                showToast('æ•°æ®åŠ è½½å¤±è´¥', 'error')\r\n            }\r\n        })\r\n\r\n        onUnmounted(() => {\r\n            window.removeEventListener('resize', checkScreenSize)\r\n        })\r\n\r\n        return {\r\n            quote,\r\n            quoteText,\r\n            quoteAuthor,\r\n            bgImageUrl,\r\n            ddlReminders,\r\n            hotPosts,\r\n            nickname,\r\n            currentDay,\r\n            daysInMonth,\r\n            dayOfWeek,\r\n            isMobileView,\r\n            selectedUniv,\r\n            followedUnivs,\r\n            availableUnivs,\r\n            allUnivs,\r\n            filteredDdlReminders,\r\n            showAddModal,\r\n            isLoading,\r\n            toast,\r\n            searchKeyword,\r\n            selectedRegion,\r\n            availableRegions,\r\n            filteredUnivs,\r\n            handleToggleFollow,\r\n            handleRemoveFollow,\r\n            openNoticeLink,\r\n            openAddModal,\r\n            getDaysLeft,\r\n            countdownText,\r\n            hasPast,\r\n            handleSelectUniv,\r\n            goPostDetail\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.responsive-layout {\r\n    display: flex;\r\n    width: 100%;\r\n    gap: 32px;\r\n    margin: 0 auto;\r\n    padding: 40px 16px;\r\n    max-width: 1400px;\r\n    justify-content: center;\r\n    margin-top: 60px;\r\n    background-color: var(--home-bg);\r\n    background-size: cover;\r\n    background-position: center;\r\n    background-attachment: fixed;\r\n    min-height: 100vh;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n/* è®©è¿™ä¸ªé¡µé¢åŒºåŸŸå æ»¡ä¸€å±ï¼Œå¹¶ä¸”ä¸è®©â€œæ•´é¡µâ€æ»šåŠ¨ */\r\n.responsive-layout {\r\n    height: calc(100vh - 60px); /* 60pxæ”¹æˆä½ é¡¶éƒ¨æ é«˜åº¦ */\r\n    overflow: hidden; /* å…³é”®ï¼šç¦æ‰å¤–å±‚æ»šåŠ¨ */\r\n    align-items: flex-start;\r\n}\r\n\r\n/* å·¦ä¾§ä¸æ»šåŠ¨ */\r\n.left-pane {\r\n    flex: 0 0 auto;\r\n    width: 300px;\r\n}\r\n\r\n/* å³ä¾§è‡ªå·±æ»šåŠ¨ */\r\n.right-pane {\r\n    flex: 1;\r\n    max-width: 900px;\r\n\r\n    height: 100%;\r\n    overflow-y: auto; /* å…³é”®ï¼šå³ä¾§å†…éƒ¨æ»šåŠ¨ */\r\n    padding-right: 8px; /* é˜²æ­¢æ»šåŠ¨æ¡é®æŒ¡å†…å®¹ï¼Œå¯é€‰ */\r\n}\r\n\r\n.mobile-layout {\r\n    flex-direction: column;\r\n    align-items: center;\r\n}\r\n\r\n.section-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.section-container:first-child {\r\n    flex: 0 0 auto;\r\n}\r\n\r\n.section-container:last-child {\r\n    flex: 1;\r\n    max-width: 900px;\r\n}\r\n\r\n.section-title {\r\n    font-size: 20px;\r\n    font-weight: 600;\r\n    color: var(--section-title-color);\r\n    margin-bottom: 16px;\r\n    border-left: 4px solid var(--section-title-border);\r\n    padding-left: 12px;\r\n    transition: color 0.3s ease, border-color 0.3s ease;\r\n}\r\n\r\n/* Daily Card Styles */\r\n.daily-card {\r\n    width: 100%;\r\n    max-width: 450px;\r\n    background-color: var(--card-bg);\r\n    border: 1px solid var(--border-color);\r\n    border-radius: 8px;\r\n    overflow: hidden;\r\n    box-shadow: var(--box-shadow);\r\n    display: flex;\r\n    flex-direction: column;\r\n    transition: background-color 0.3s ease, border 0.3s ease,\r\n        box-shadow 0.3s ease;\r\n}\r\n\r\n.card-image {\r\n    width: 100%;\r\n    position: relative;\r\n    padding-bottom: 100%;\r\n    overflow: hidden;\r\n    background-color: #f5f5f5;\r\n}\r\n\r\n.card-image img {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    border-bottom: 1px solid var(--border-color);\r\n    transition: border-bottom 0.3s ease;\r\n}\r\n\r\n.card-content {\r\n    padding: 24px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n}\r\n\r\n.quote-text {\r\n    white-space: pre-line;\r\n    font-size: 16px;\r\n    line-height: 1.8;\r\n    color: var(--text-primary);\r\n    text-align: center;\r\n    margin-bottom: 16px;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.quote-author {\r\n    font-size: 14px;\r\n    color: var(--text-secondary);\r\n    text-align: center;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.card-footer {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 12px 16px;\r\n    border-top: 1px solid var(--border-color);\r\n    transition: border-top 0.3s ease;\r\n}\r\n\r\n.service-info {\r\n    font-size: 12px;\r\n    color: var(--text-tertiary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.date-box {\r\n    text-align: right;\r\n    padding: 8px;\r\n    border: 1px solid var(--border-color);\r\n    transition: border 0.3s ease;\r\n}\r\n\r\n.date {\r\n    font-size: 16px;\r\n    color: var(--text-primary);\r\n    font-weight: bold;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.day {\r\n    font-size: 14px;\r\n    color: var(--text-secondary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n/* Info Grid Styles */\r\n.info-grid {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 24px;\r\n}\r\n\r\n.info-card {\r\n    background: var(--card-bg);\r\n    border: 1px solid var(--border-color);\r\n    border-radius: 16px;\r\n    padding: 24px;\r\n    box-shadow: var(--box-shadow);\r\n    transition: background-color 0.3s ease, border 0.3s ease,\r\n        box-shadow 0.3s ease;\r\n}\r\n\r\n.card-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.card-title {\r\n    font-size: 18px;\r\n    font-weight: 600;\r\n    color: var(--text-primary);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    margin: 0;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.star-icon {\r\n    font-size: 20px;\r\n}\r\n\r\n.add-btn {\r\n    background: #f0f7ff;\r\n    color: #4a90e2;\r\n    border: none;\r\n    border-radius: 8px;\r\n    padding: 8px 16px;\r\n    font-size: 14px;\r\n    cursor: pointer;\r\n    transition: all 0.3s ease;\r\n}\r\n\r\n.add-btn:hover {\r\n    background: #e3f2fd;\r\n}\r\n\r\n.top-label {\r\n    font-size: 14px;\r\n    color: #666;\r\n    font-weight: 500;\r\n}\r\n\r\n.tags-container {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 12px;\r\n    margin-bottom: 24px;\r\n}\r\n\r\n.tag {\r\n    background: #e8f4ff;\r\n    color: #4a90e2;\r\n    padding: 8px 16px;\r\n    border-radius: 20px;\r\n    font-size: 14px;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.tag-close {\r\n    cursor: pointer;\r\n    font-size: 16px;\r\n    opacity: 0.7;\r\n    transition: opacity 0.2s;\r\n}\r\n\r\n.tag-close:hover {\r\n    opacity: 1;\r\n}\r\n\r\n.ddl-section {\r\n    margin-top: 20px;\r\n}\r\n\r\n.section-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 16px;\r\n}\r\n\r\n.section-label {\r\n    font-size: 15px;\r\n    font-weight: 600;\r\n    color: var(--text-primary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.from-label {\r\n    font-size: 13px;\r\n    color: var(--text-tertiary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.ddl-item {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 16px;\r\n    background: var(--ddl-item);\r\n    border-radius: 12px;\r\n    margin-bottom: 12px;\r\n    transition: all 0.3s ease;\r\n}\r\n\r\n.ddl-item:hover {\r\n    background: var(--ddl-item-hover);\r\n    transform: translateX(4px);\r\n}\r\n\r\n.ddl-info {\r\n    flex: 1;\r\n}\r\n\r\n.ddl-title {\r\n    font-size: 15px;\r\n    font-weight: 600;\r\n    color: var(--text-primary);\r\n    margin-bottom: 4px;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.ddl-subtitle {\r\n    font-size: 14px;\r\n    color: var(--text-secondary);\r\n    margin-bottom: 6px;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.ddl-deadline {\r\n    font-size: 13px;\r\n    color: #e74c3c;\r\n}\r\n\r\n.ddl-countdown {\r\n    background: linear-gradient(135deg, #ffd93d 0%, #ffaa33 100%);\r\n    color: #fff;\r\n    padding: 8px 16px;\r\n    border-radius: 8px;\r\n    font-size: 14px;\r\n    font-weight: 600;\r\n    white-space: nowrap;\r\n}\r\n\r\n.posts-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 16px;\r\n}\r\n\r\n.post-item {\r\n    display: flex;\r\n    gap: 16px;\r\n    padding: 16px;\r\n    background: var(--ddl-item);\r\n    border-radius: 12px;\r\n    transition: all 0.3s ease;\r\n    cursor: pointer;\r\n}\r\n\r\n.post-item:hover {\r\n    background: var(--ddl-item-hover);\r\n    transform: translateX(4px);\r\n}\r\n\r\n.post-rank {\r\n    font-size: 18px;\r\n    font-weight: 700;\r\n    color: #4a90e2;\r\n    min-width: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.post-item:first-child .post-rank {\r\n    color: #f39c12;\r\n}\r\n\r\n.post-item:nth-child(2) .post-rank {\r\n    color: #95a5a6;\r\n}\r\n\r\n.post-item:nth-child(3) .post-rank {\r\n    color: #cd7f32;\r\n}\r\n\r\n.post-content {\r\n    flex: 1;\r\n}\r\n\r\n.post-title {\r\n    font-size: 15px;\r\n    font-weight: 500;\r\n    color: var(--text-primary);\r\n    margin-bottom: 8px;\r\n    line-height: 1.4;\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.post-meta {\r\n    display: flex;\r\n    gap: 16px;\r\n    font-size: 13px;\r\n    color: var(--text-tertiary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.post-source {\r\n    color: var(--text-secondary);\r\n    transition: color 0.3s ease;\r\n}\r\n\r\n.post-views {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.tag.active {\r\n    background: #e8f1ff;\r\n    border: 1px solid #6aa7ff;\r\n}\r\n\r\n.ddl-countdown.expired {\r\n    opacity: 0.7;\r\n}\r\n\r\n.modal-overlay {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n    background: white;\r\n    border-radius: 12px;\r\n    width: 90%;\r\n    max-width: 500px;\r\n    max-height: 80vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.modal-header {\r\n    padding: 20px;\r\n    border-bottom: 1px solid #eee;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n\r\n.modal-header h3 {\r\n    margin: 0;\r\n    font-size: 18px;\r\n}\r\n\r\n.close-btn {\r\n    background: none;\r\n    border: none;\r\n    font-size: 24px;\r\n    cursor: pointer;\r\n    color: #666;\r\n    padding: 0;\r\n    width: 30px;\r\n    height: 30px;\r\n    line-height: 30px;\r\n}\r\n\r\n.close-btn:hover {\r\n    color: #333;\r\n}\r\n\r\n.modal-body {\r\n    padding: 20px;\r\n    overflow-y: auto;\r\n    flex: 1;\r\n}\r\n\r\n.univ-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 12px;\r\n}\r\n\r\n.univ-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    padding: 10px;\r\n    border: 1px solid #e0e0e0;\r\n    border-radius: 8px;\r\n    cursor: pointer;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.univ-item:hover {\r\n    background: #f5f5f5;\r\n    border-color: #4caf50;\r\n}\r\n\r\n.univ-item input[type='checkbox'] {\r\n    cursor: pointer;\r\n}\r\n\r\n.modal-footer {\r\n    padding: 15px 20px;\r\n    border-top: 1px solid #eee;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.btn-cancel {\r\n    padding: 8px 20px;\r\n    border: 1px solid #ddd;\r\n    background: white;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n}\r\n\r\n.btn-cancel:hover {\r\n    background: #f5f5f5;\r\n}\r\n\r\n.empty-message {\r\n    text-align: center;\r\n    padding: 40px 20px;\r\n    color: #999;\r\n    font-size: 14px;\r\n}\r\n\r\n.ddl-countdown.expired {\r\n    color: #999;\r\n    opacity: 0.6;\r\n}\r\n\r\n.add-btn {\r\n    cursor: pointer;\r\n}\r\n\r\n/* Toast æ ·å¼ */\r\n.toast {\r\n    position: fixed;\r\n    top: 20px;\r\n    right: 20px;\r\n    padding: 12px 24px;\r\n    border-radius: 8px;\r\n    color: white;\r\n    font-size: 14px;\r\n    z-index: 9999;\r\n    animation: slideIn 0.3s ease-out;\r\n}\r\n\r\n.toast.success {\r\n    background-color: #52c41a;\r\n}\r\n\r\n.toast.error {\r\n    background-color: #ff4d4f;\r\n}\r\n\r\n@keyframes slideIn {\r\n    from {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n    }\r\n    to {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n/* DDL Item å¯ç‚¹å‡»æ ·å¼ */\r\n.ddl-item {\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n}\r\n\r\n.ddl-item:hover {\r\n    background-color: #f5f5f5;\r\n    transform: translateX(4px);\r\n}\r\n\r\n.ddl-item:active {\r\n    transform: translateX(2px);\r\n}\r\n\r\n/* Loading å’Œ Empty æ¶ˆæ¯æ ·å¼ */\r\n.loading-message,\r\n.empty-message {\r\n    text-align: center;\r\n    padding: 40px 20px;\r\n    color: #999;\r\n    font-size: 14px;\r\n}\r\n\r\n.loading-message {\r\n    color: #1890ff;\r\n}\r\n.univ-item.disabled {\r\n    opacity: 0.6;\r\n    cursor: not-allowed;\r\n}\r\n\r\n.univ-item.disabled input {\r\n    cursor: not-allowed;\r\n}\r\n\r\nbutton:disabled {\r\n    opacity: 0.6;\r\n    cursor: not-allowed;\r\n}\r\n\r\n/* å¼¹çª—æœç´¢å’Œç­›é€‰æ ·å¼ */\r\n.modal-filters {\r\n    padding: 0 24px 16px;\r\n    border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.search-box {\r\n    margin-bottom: 16px;\r\n}\r\n\r\n.search-input {\r\n    width: 100%;\r\n    padding: 10px 16px;\r\n    border: 1px solid #d9d9d9;\r\n    border-radius: 8px;\r\n    font-size: 14px;\r\n    outline: none;\r\n    transition: all 0.3s;\r\n}\r\n\r\n.search-input:focus {\r\n    border-color: #1890ff;\r\n    box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.search-input::placeholder {\r\n    color: #bfbfbf;\r\n}\r\n\r\n.region-filters {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n    max-height: 120px;\r\n    overflow-y: auto;\r\n}\r\n\r\n.region-btn {\r\n    padding: 6px 16px;\r\n    border: 1px solid #d9d9d9;\r\n    border-radius: 16px;\r\n    background: white;\r\n    color: #595959;\r\n    font-size: 13px;\r\n    cursor: pointer;\r\n    transition: all 0.3s;\r\n    white-space: nowrap;\r\n}\r\n\r\n.region-btn:hover {\r\n    border-color: #40a9ff;\r\n    color: #40a9ff;\r\n}\r\n\r\n.region-btn.active {\r\n    background: #1890ff;\r\n    border-color: #1890ff;\r\n    color: white;\r\n}\r\n\r\n.region-btn:disabled {\r\n    opacity: 0.5;\r\n    cursor: not-allowed;\r\n}\r\n\r\n/* è°ƒæ•´å¼¹çª—ä¸»ä½“é«˜åº¦ */\r\n.modal-body {\r\n    max-height: 350px;\r\n    overflow-y: auto;\r\n}\r\n\r\n/* Responsive Styles */\r\n@media (max-width: 1000px) {\r\n    .responsive-layout {\r\n        flex-direction: column;\r\n        align-items: center;\r\n        gap: 20px; /* æ”¶ç´§ä¸¤å—ä¹‹é—´é—´è· */\r\n        height: auto; /* æ¢å¤æ•´é¡µæ»šåŠ¨ï¼ˆå¦‚æœä½ æ¡Œé¢ç«¯åšäº†å³ä¾§æ»šåŠ¨ï¼‰ */\r\n        overflow: visible;\r\n        padding: 24px 12px; /* æ”¶ç´§å¤–è¾¹è· */\r\n    }\r\n\r\n    .left-pane,\r\n    .right-pane {\r\n        width: 100%;\r\n        max-width: 600px;\r\n        height: auto;\r\n        overflow: visible;\r\n        padding-right: 0;\r\n    }\r\n\r\n    /* ä¸è¦å†ç”¨ first/last-child å…œåº•ï¼Œç›´æ¥å¯¹å®¹å™¨ç”Ÿæ•ˆæ›´ç¨³ */\r\n    .section-container {\r\n        width: 100%;\r\n    }\r\n}\r\n\r\n@media (max-width: 800px) {\r\n    .responsive-layout {\r\n        padding: 20px 12px;\r\n        gap: 24px;\r\n    }\r\n\r\n    .section-container:first-child,\r\n    .section-container:last-child {\r\n        max-width: 100%;\r\n    }\r\n\r\n    .daily-card {\r\n        max-width: 100%;\r\n    }\r\n\r\n    .card-header {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        gap: 12px;\r\n    }\r\n\r\n    .add-btn {\r\n        width: 100%;\r\n    }\r\n\r\n    .section-header {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        gap: 8px;\r\n    }\r\n\r\n    .ddl-item {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        gap: 12px;\r\n    }\r\n\r\n    .ddl-countdown {\r\n        align-self: flex-end;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}