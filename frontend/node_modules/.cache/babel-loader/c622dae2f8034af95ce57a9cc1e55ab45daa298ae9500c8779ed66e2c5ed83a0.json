{"ast":null,"code":"import axios from 'axios';\nconst pdfHttp = axios.create({\n  baseURL: '/api',\n  timeout: 120000 // ✅ chat 给 2 分钟\n});\n\n// 如果你其它接口用 http.js 的拦截器，这里也可以复制同样的 response 拦截逻辑\npdfHttp.interceptors.response.use(res => {\n  const body = res.data;\n  if (!body || typeof body !== 'object' || !('code' in body)) return body;\n  if (body.code === 200) return body;\n  return Promise.reject(new Error(body.msg || '请求失败'));\n}, err => Promise.reject(err));\nexport function uploadPdfAPI(formData) {\n  return pdfHttp.post('/pdf/upload', formData);\n}\nexport function chatPdfAPI({\n  session_id,\n  question\n}) {\n  return pdfHttp.post('/pdf/chat', {\n    session_id,\n    question\n  });\n}\nexport function clearPdfSessionAPI(session_id) {\n  return pdfHttp.post('/pdf/clear', {\n    session_id\n  });\n}\nexport async function chatPdfStreamAPI({\n  session_id,\n  question,\n  signal\n}) {\n  // ⚠️ 这里的 baseURL 你按项目实际情况：一般是 '/api/v1'\n  const url = `/api/v1/pdf/chat/stream`;\n  const resp = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      session_id,\n      question\n    }),\n    signal\n  });\n  if (!resp.ok) {\n    // HTTP 层错误（比如 502、404）\n    throw new Error(`HTTP ${resp.status} ${resp.statusText}`);\n  }\n  if (!resp.body) {\n    throw new Error('响应不包含可读流（resp.body 为空）');\n  }\n  return resp; // 返回 response，让上层自己 reader.read()\n}","map":{"version":3,"names":["axios","pdfHttp","create","baseURL","timeout","interceptors","response","use","res","body","data","code","Promise","reject","Error","msg","err","uploadPdfAPI","formData","post","chatPdfAPI","session_id","question","clearPdfSessionAPI","chatPdfStreamAPI","signal","url","resp","fetch","method","headers","JSON","stringify","ok","status","statusText"],"sources":["D:/Projects/Service-Outsourcing-Innovation-and-Entrepreneurship-Competition/frontend/src/api/pdf.js"],"sourcesContent":["import axios from 'axios'\r\n\r\nconst pdfHttp = axios.create({\r\n    baseURL: '/api',\r\n    timeout: 120000 // ✅ chat 给 2 分钟\r\n})\r\n\r\n// 如果你其它接口用 http.js 的拦截器，这里也可以复制同样的 response 拦截逻辑\r\npdfHttp.interceptors.response.use(\r\n    res => {\r\n        const body = res.data\r\n        if (!body || typeof body !== 'object' || !('code' in body)) return body\r\n        if (body.code === 200) return body\r\n        return Promise.reject(new Error(body.msg || '请求失败'))\r\n    },\r\n    err => Promise.reject(err)\r\n)\r\n\r\nexport function uploadPdfAPI(formData) {\r\n    return pdfHttp.post('/pdf/upload', formData)\r\n}\r\n\r\nexport function chatPdfAPI({ session_id, question }) {\r\n    return pdfHttp.post('/pdf/chat', { session_id, question })\r\n}\r\n\r\nexport function clearPdfSessionAPI(session_id) {\r\n    return pdfHttp.post('/pdf/clear', { session_id })\r\n}\r\n\r\nexport async function chatPdfStreamAPI({ session_id, question, signal }) {\r\n    // ⚠️ 这里的 baseURL 你按项目实际情况：一般是 '/api/v1'\r\n    const url = `/api/v1/pdf/chat/stream`\r\n\r\n    const resp = await fetch(url, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ session_id, question }),\r\n        signal\r\n    })\r\n\r\n    if (!resp.ok) {\r\n        // HTTP 层错误（比如 502、404）\r\n        throw new Error(`HTTP ${resp.status} ${resp.statusText}`)\r\n    }\r\n\r\n    if (!resp.body) {\r\n        throw new Error('响应不包含可读流（resp.body 为空）')\r\n    }\r\n\r\n    return resp // 返回 response，让上层自己 reader.read()\r\n}\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAGD,KAAK,CAACE,MAAM,CAAC;EACzBC,OAAO,EAAE,MAAM;EACfC,OAAO,EAAE,MAAM,CAAC;AACpB,CAAC,CAAC;;AAEF;AACAH,OAAO,CAACI,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC7BC,GAAG,IAAI;EACH,MAAMC,IAAI,GAAGD,GAAG,CAACE,IAAI;EACrB,IAAI,CAACD,IAAI,IAAI,OAAOA,IAAI,KAAK,QAAQ,IAAI,EAAE,MAAM,IAAIA,IAAI,CAAC,EAAE,OAAOA,IAAI;EACvE,IAAIA,IAAI,CAACE,IAAI,KAAK,GAAG,EAAE,OAAOF,IAAI;EAClC,OAAOG,OAAO,CAACC,MAAM,CAAC,IAAIC,KAAK,CAACL,IAAI,CAACM,GAAG,IAAI,MAAM,CAAC,CAAC;AACxD,CAAC,EACDC,GAAG,IAAIJ,OAAO,CAACC,MAAM,CAACG,GAAG,CAC7B,CAAC;AAED,OAAO,SAASC,YAAYA,CAACC,QAAQ,EAAE;EACnC,OAAOjB,OAAO,CAACkB,IAAI,CAAC,aAAa,EAAED,QAAQ,CAAC;AAChD;AAEA,OAAO,SAASE,UAAUA,CAAC;EAAEC,UAAU;EAAEC;AAAS,CAAC,EAAE;EACjD,OAAOrB,OAAO,CAACkB,IAAI,CAAC,WAAW,EAAE;IAAEE,UAAU;IAAEC;EAAS,CAAC,CAAC;AAC9D;AAEA,OAAO,SAASC,kBAAkBA,CAACF,UAAU,EAAE;EAC3C,OAAOpB,OAAO,CAACkB,IAAI,CAAC,YAAY,EAAE;IAAEE;EAAW,CAAC,CAAC;AACrD;AAEA,OAAO,eAAeG,gBAAgBA,CAAC;EAAEH,UAAU;EAAEC,QAAQ;EAAEG;AAAO,CAAC,EAAE;EACrE;EACA,MAAMC,GAAG,GAAG,yBAAyB;EAErC,MAAMC,IAAI,GAAG,MAAMC,KAAK,CAACF,GAAG,EAAE;IAC1BG,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CrB,IAAI,EAAEsB,IAAI,CAACC,SAAS,CAAC;MAAEX,UAAU;MAAEC;IAAS,CAAC,CAAC;IAC9CG;EACJ,CAAC,CAAC;EAEF,IAAI,CAACE,IAAI,CAACM,EAAE,EAAE;IACV;IACA,MAAM,IAAInB,KAAK,CAAC,QAAQa,IAAI,CAACO,MAAM,IAAIP,IAAI,CAACQ,UAAU,EAAE,CAAC;EAC7D;EAEA,IAAI,CAACR,IAAI,CAAClB,IAAI,EAAE;IACZ,MAAM,IAAIK,KAAK,CAAC,wBAAwB,CAAC;EAC7C;EAEA,OAAOa,IAAI,EAAC;AAChB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}