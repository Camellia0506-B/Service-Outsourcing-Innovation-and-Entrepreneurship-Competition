{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"pdf-agent-page\"\n};\nconst _hoisted_2 = {\n  class: \"chat-container\",\n  ref: \"chatContainer\"\n};\nconst _hoisted_3 = {\n  class: \"message-content\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"message-text assistant-streaming\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"typing-indicator\"\n};\nconst _hoisted_6 = [\"innerHTML\"];\nconst _hoisted_7 = [\"innerHTML\"];\nconst _hoisted_8 = {\n  class: \"message-time\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"chat-message assistant\"\n};\nconst _hoisted_10 = {\n  class: \"input-section\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"uploaded-files\"\n};\nconst _hoisted_12 = {\n  class: \"file-size\"\n};\nconst _hoisted_13 = {\n  key: 0,\n  class: \"file-pages\"\n};\nconst _hoisted_14 = [\"onClick\"];\nconst _hoisted_15 = [\"placeholder\", \"disabled\"];\nconst _hoisted_16 = [\"disabled\"];\nconst _hoisted_17 = {\n  class: \"modal-card\"\n};\nconst _hoisted_18 = {\n  class: \"type-grid\"\n};\nconst _hoisted_19 = [\"onClick\"];\nconst _hoisted_20 = {\n  class: \"modal-actions\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" ËÅäÂ§©Ê∂àÊÅØÂå∫Âüü \"), _createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.messages, message => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: message.id,\n      class: _normalizeClass(['chat-message', message.role])\n    }, [_createElementVNode(\"div\", _hoisted_3, [_createCommentVNode(\" ‚úÖ ÊµÅÂºèÈò∂ÊÆµÔºöÁ∫ØÊñáÊú¨ÊòæÁ§∫ \"), message.role === 'assistant' && message.streaming ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createCommentVNode(\" ‚úÖ È¶ñ token Êú™Âà∞ÔºöÊòæÁ§∫Á≠âÂæÖÂä®Áîª \"), $setup.waitingFirstToken ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[5] || (_cache[5] = [_createElementVNode(\"span\", null, null, -1 /* HOISTED */), _createElementVNode(\"span\", null, null, -1 /* HOISTED */), _createElementVNode(\"span\", null, null, -1 /* HOISTED */)]))])) : (_openBlock(), _createElementBlock(_Fragment, {\n      key: 1\n    }, [_createCommentVNode(\" ‚úÖ Â∑≤Êúâ tokenÔºöÂºÄÂßãÊµÅÂºèÂÜÖÂÆπ \"), _createElementVNode(\"div\", {\n      innerHTML: $setup.renderStreamingMarkdown(message.content)\n    }, null, 8 /* PROPS */, _hoisted_6)], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))])) : (_openBlock(), _createElementBlock(_Fragment, {\n      key: 1\n    }, [_createCommentVNode(\" ‚úÖ ÈùûÊµÅÂºèÔºömarkdown Ê∏≤Êüì \"), _createElementVNode(\"div\", {\n      class: \"message-text markdown-body assistant-markdown\",\n      innerHTML: message.html ?? $setup.renderMarkdown(message.content)\n    }, null, 8 /* PROPS */, _hoisted_7)], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)), _createElementVNode(\"div\", _hoisted_8, _toDisplayString($setup.formatTime(message.timestamp)), 1 /* TEXT */)])], 2 /* CLASS */);\n  }), 128 /* KEYED_FRAGMENT */)), _createCommentVNode(\" ‚úÖ Âä†ËΩΩÁä∂ÊÄÅÔºö‰ªÖÂú®Ê≤°ÊúâÊµÅÂºèÊ∂àÊÅØÊó∂ÊòæÁ§∫ \"), $setup.isLoading && !$setup.messages[$setup.messages.length - 1]?.streaming ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, _cache[6] || (_cache[6] = [_createElementVNode(\"div\", {\n    class: \"message-content\"\n  }, [_createElementVNode(\"div\", {\n    class: \"typing-indicator\"\n  }, [_createElementVNode(\"span\"), _createElementVNode(\"span\"), _createElementVNode(\"span\")])], -1 /* HOISTED */)]))) : _createCommentVNode(\"v-if\", true)], 512 /* NEED_PATCH */), _createCommentVNode(\" ËæìÂÖ•Âå∫Âüü \"), _createElementVNode(\"div\", _hoisted_10, [_createCommentVNode(\" Â∑≤‰∏ä‰º†Êñá‰ª∂ÊòæÁ§∫ \"), $setup.uploadedFiles.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.uploadedFiles, (file, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"file-chip\"\n    }, [_createElementVNode(\"span\", null, \"üìé \" + _toDisplayString(file.name), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_12, \"(\" + _toDisplayString($setup.formatFileSize(file.size)) + \")\", 1 /* TEXT */), $setup.pdfInfo ? (_openBlock(), _createElementBlock(\"span\", _hoisted_13, \"üìÑ \" + _toDisplayString($setup.pdfInfo.page_count) + \"È°µ\", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"span\", {\n      class: \"remove-btn\",\n      onClick: $event => $setup.removeFile(index)\n    }, \"√ó\", 8 /* PROPS */, _hoisted_14)]);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" ËæìÂÖ•Ê°Ü \"), _createElementVNode(\"div\", {\n    class: _normalizeClass([\"input-box\", {\n      'drag-over': $setup.isDragging\n    }]),\n    onDragover: _cache[2] || (_cache[2] = _withModifiers($event => $setup.isDragging = true, [\"prevent\"])),\n    onDragleave: _cache[3] || (_cache[3] = _withModifiers($event => $setup.isDragging = false, [\"prevent\"])),\n    onDrop: _withModifiers($setup.handleDrop, [\"prevent\"])\n  }, [_createElementVNode(\"input\", {\n    ref: \"fileInput\",\n    type: \"file\",\n    accept: \".pdf\",\n    onChange: $setup.handleFileSelect,\n    style: {\n      \"display\": \"none\"\n    }\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), _createElementVNode(\"button\", {\n    class: \"icon-btn upload-btn\",\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$refs.fileInput.click()),\n    title: \"‰∏ä‰º†PDFÊñá‰ª∂\"\n  }, _cache[7] || (_cache[7] = [_createElementVNode(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"2\"\n  }, [_createElementVNode(\"path\", {\n    d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"\n  }), _createElementVNode(\"polyline\", {\n    points: \"17 8 12 3 7 8\"\n  }), _createElementVNode(\"line\", {\n    x1: \"12\",\n    y1: \"3\",\n    x2: \"12\",\n    y2: \"15\"\n  })], -1 /* HOISTED */)])), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.inputMessage = $event),\n    type: \"text\",\n    class: \"text-input\",\n    placeholder: !$setup.sessionId ? 'ËØ∑ÂÖà‰∏ä‰º†PDFÊñá‰ª∂' : !$setup.typeConfirmed ? 'ËØ∑ÂÖàÈÄâÊã©ÊùêÊñôÁ±ªÂûãÔºàÁÆÄÂéÜ/Èù¢ËØïPPT/Â•óÁ£ÅÈÇÆ‰ª∂/Èù¢ËØïÁ®ø/Ê®°ÊãüÊèêÈóÆÔºâ' : 'ÂêëÊàëÊèêÈóÆÊñáÊ°£ÂÜÖÂÆπ...',\n    disabled: !$setup.sessionId || !$setup.typeConfirmed,\n    onKeydown: _withKeys($setup.handleSendMessage, [\"enter\"])\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_15), [[_vModelText, $setup.inputMessage]]), _createElementVNode(\"button\", {\n    class: \"icon-btn send-btn\",\n    disabled: !$setup.canSend,\n    onClick: $setup.handleSendMessage,\n    title: \"ÂèëÈÄÅÊ∂àÊÅØ\"\n  }, _cache[8] || (_cache[8] = [_createElementVNode(\"svg\", {\n    width: \"20\",\n    height: \"20\",\n    viewBox: \"0 0 24 24\",\n    fill: \"currentColor\"\n  }, [_createElementVNode(\"path\", {\n    d: \"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"\n  })], -1 /* HOISTED */)]), 8 /* PROPS */, _hoisted_16)], 34 /* CLASS, NEED_HYDRATION */), _cache[9] || (_cache[9] = _createElementVNode(\"div\", {\n    class: \"input-hint\"\n  }, \" ÊîØÊåÅPDFÊ†ºÂºèÊñáÊ°£Ôºà‚â§10MBÔºâÔΩúÊãñÊãΩ‰∏ä‰º†ÊàñÁÇπÂáªÊåâÈíÆÔΩúÂàÜÊûêÂâç10È°µÂÜÖÂÆπÔΩúÂ§öËΩÆÂØπËØùËÆ∞‰Ωè‰∏ä‰∏ãÊñá \", -1 /* HOISTED */))]), _createCommentVNode(\" ‚úÖ ÊùêÊñôÁ±ªÂûãÈÄâÊã©ÂºπÁ™ó \"), $setup.showTypeModal ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"modal-mask\",\n    onClick: _withModifiers(() => {}, [\"self\"])\n  }, [_createElementVNode(\"div\", _hoisted_17, [_cache[10] || (_cache[10] = _createElementVNode(\"div\", {\n    class: \"modal-title\"\n  }, \"ËØ∑ÈÄâÊã©ÊùêÊñôÁ±ªÂûã\", -1 /* HOISTED */)), _cache[11] || (_cache[11] = _createElementVNode(\"div\", {\n    class: \"modal-sub\"\n  }, \" ÈÄâÊã©ÂêéÊàë‰ºöÊåâÂØπÂ∫î\\\"‰øùÁ†îÂú∫ÊôØ\\\"ËæìÂá∫Êõ¥Á≤æÂáÜÁöÑÁªìÊûÑ‰∏éÊ®°Êùø„ÄÇ \", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_18, [(_openBlock(), _createElementBlock(_Fragment, null, _renderList($setup.DOC_TYPE_OPTIONS, opt => {\n    return _createElementVNode(\"button\", {\n      key: opt.value,\n      class: _normalizeClass([\"type-btn\", {\n        active: $setup.docType === opt.value\n      }]),\n      onClick: $event => $setup.docType = opt.value\n    }, _toDisplayString(opt.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_19);\n  }), 64 /* STABLE_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"button\", {\n    class: \"confirm-btn\",\n    onClick: _cache[4] || (_cache[4] = () => {\n      $setup.typeConfirmed = true;\n      $setup.showTypeModal = false;\n      $setup.messages.push({\n        role: 'assistant',\n        content: `‚úÖ Â∑≤ÈÄâÊã©Ôºö${$setup.DOC_TYPE_OPTIONS.find(x => x.value === $setup.docType)?.label}„ÄÇ\\nÁé∞Âú®ÂèØ‰ª•ÂºÄÂßãÊèêÈóÆ‰∫ÜÔºÅ`,\n        timestamp: new Date()\n      });\n    })\n  }, \" Á°ÆËÆ§ \")])])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","ref","key","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","_Fragment","_renderList","$setup","messages","message","id","_normalizeClass","role","_hoisted_3","streaming","_hoisted_4","waitingFirstToken","_hoisted_5","_cache","innerHTML","renderStreamingMarkdown","content","_hoisted_6","html","renderMarkdown","_hoisted_7","_hoisted_8","_toDisplayString","formatTime","timestamp","isLoading","length","_hoisted_9","_hoisted_10","uploadedFiles","_hoisted_11","file","index","name","_hoisted_12","formatFileSize","size","pdfInfo","_hoisted_13","page_count","onClick","$event","removeFile","_hoisted_14","isDragging","onDragover","_withModifiers","onDragleave","onDrop","handleDrop","type","accept","onChange","handleFileSelect","style","_ctx","$refs","fileInput","click","title","width","height","viewBox","fill","stroke","d","points","x1","y1","x2","y2","inputMessage","placeholder","sessionId","typeConfirmed","disabled","onKeydown","_withKeys","handleSendMessage","_hoisted_15","canSend","_hoisted_16","showTypeModal","_hoisted_17","_hoisted_18","DOC_TYPE_OPTIONS","opt","value","active","docType","label","_hoisted_19","_hoisted_20","push","find","x","Date"],"sources":["D:\\Projects\\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\\frontend\\src\\views\\AI.vue"],"sourcesContent":["<template>\r\n    <div class=\"pdf-agent-page\">\r\n        <!-- ËÅäÂ§©Ê∂àÊÅØÂå∫Âüü -->\r\n        <div class=\"chat-container\" ref=\"chatContainer\">\r\n            <div\r\n                v-for=\"message in messages\"\r\n                :key=\"message.id\"\r\n                :class=\"['chat-message', message.role]\"\r\n            >\r\n                <div class=\"message-content\">\r\n                    <!-- ‚úÖ ÊµÅÂºèÈò∂ÊÆµÔºöÁ∫ØÊñáÊú¨ÊòæÁ§∫ -->\r\n                    <div\r\n                        v-if=\"message.role === 'assistant' && message.streaming\"\r\n                        class=\"message-text assistant-streaming\"\r\n                    >\r\n                        <!-- ‚úÖ È¶ñ token Êú™Âà∞ÔºöÊòæÁ§∫Á≠âÂæÖÂä®Áîª -->\r\n                        <div v-if=\"waitingFirstToken\" class=\"typing-indicator\">\r\n                            <span></span><span></span><span></span>\r\n                        </div>\r\n\r\n                        <!-- ‚úÖ Â∑≤Êúâ tokenÔºöÂºÄÂßãÊµÅÂºèÂÜÖÂÆπ -->\r\n                        <div\r\n                            v-else\r\n                            v-html=\"renderStreamingMarkdown(message.content)\"\r\n                        />\r\n                    </div>\r\n\r\n                    <!-- ‚úÖ ÈùûÊµÅÂºèÔºömarkdown Ê∏≤Êüì -->\r\n                    <div\r\n                        v-else\r\n                        class=\"message-text markdown-body assistant-markdown\"\r\n                        v-html=\"message.html ?? renderMarkdown(message.content)\"\r\n                    ></div>\r\n\r\n                    <div class=\"message-time\">\r\n                        {{ formatTime(message.timestamp) }}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- ‚úÖ Âä†ËΩΩÁä∂ÊÄÅÔºö‰ªÖÂú®Ê≤°ÊúâÊµÅÂºèÊ∂àÊÅØÊó∂ÊòæÁ§∫ -->\r\n            <div\r\n                v-if=\"isLoading && !messages[messages.length - 1]?.streaming\"\r\n                class=\"chat-message assistant\"\r\n            >\r\n                <div class=\"message-content\">\r\n                    <div class=\"typing-indicator\">\r\n                        <span></span>\r\n                        <span></span>\r\n                        <span></span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- ËæìÂÖ•Âå∫Âüü -->\r\n        <div class=\"input-section\">\r\n            <!-- Â∑≤‰∏ä‰º†Êñá‰ª∂ÊòæÁ§∫ -->\r\n            <div v-if=\"uploadedFiles.length > 0\" class=\"uploaded-files\">\r\n                <div\r\n                    v-for=\"(file, index) in uploadedFiles\"\r\n                    :key=\"index\"\r\n                    class=\"file-chip\"\r\n                >\r\n                    <span>üìé {{ file.name }}</span>\r\n                    <span class=\"file-size\"\r\n                        >({{ formatFileSize(file.size) }})</span\r\n                    >\r\n                    <span v-if=\"pdfInfo\" class=\"file-pages\"\r\n                        >üìÑ {{ pdfInfo.page_count }}È°µ</span\r\n                    >\r\n                    <span class=\"remove-btn\" @click=\"removeFile(index)\">√ó</span>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- ËæìÂÖ•Ê°Ü -->\r\n            <div\r\n                class=\"input-box\"\r\n                :class=\"{ 'drag-over': isDragging }\"\r\n                @dragover.prevent=\"isDragging = true\"\r\n                @dragleave.prevent=\"isDragging = false\"\r\n                @drop.prevent=\"handleDrop\"\r\n            >\r\n                <input\r\n                    ref=\"fileInput\"\r\n                    type=\"file\"\r\n                    accept=\".pdf\"\r\n                    @change=\"handleFileSelect\"\r\n                    style=\"display: none\"\r\n                />\r\n\r\n                <button\r\n                    class=\"icon-btn upload-btn\"\r\n                    @click=\"$refs.fileInput.click()\"\r\n                    title=\"‰∏ä‰º†PDFÊñá‰ª∂\"\r\n                >\r\n                    <svg\r\n                        width=\"20\"\r\n                        height=\"20\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        stroke-width=\"2\"\r\n                    >\r\n                        <path\r\n                            d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"\r\n                        ></path>\r\n                        <polyline points=\"17 8 12 3 7 8\"></polyline>\r\n                        <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"></line>\r\n                    </svg>\r\n                </button>\r\n\r\n                <input\r\n                    v-model=\"inputMessage\"\r\n                    type=\"text\"\r\n                    class=\"text-input\"\r\n                    :placeholder=\"\r\n                        !sessionId\r\n                            ? 'ËØ∑ÂÖà‰∏ä‰º†PDFÊñá‰ª∂'\r\n                            : !typeConfirmed\r\n                            ? 'ËØ∑ÂÖàÈÄâÊã©ÊùêÊñôÁ±ªÂûãÔºàÁÆÄÂéÜ/Èù¢ËØïPPT/Â•óÁ£ÅÈÇÆ‰ª∂/Èù¢ËØïÁ®ø/Ê®°ÊãüÊèêÈóÆÔºâ'\r\n                            : 'ÂêëÊàëÊèêÈóÆÊñáÊ°£ÂÜÖÂÆπ...'\r\n                    \"\r\n                    :disabled=\"!sessionId || !typeConfirmed\"\r\n                    @keydown.enter=\"handleSendMessage\"\r\n                />\r\n\r\n                <button\r\n                    class=\"icon-btn send-btn\"\r\n                    :disabled=\"!canSend\"\r\n                    @click=\"handleSendMessage\"\r\n                    title=\"ÂèëÈÄÅÊ∂àÊÅØ\"\r\n                >\r\n                    <svg\r\n                        width=\"20\"\r\n                        height=\"20\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill=\"currentColor\"\r\n                    >\r\n                        <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"></path>\r\n                    </svg>\r\n                </button>\r\n            </div>\r\n\r\n            <div class=\"input-hint\">\r\n                ÊîØÊåÅPDFÊ†ºÂºèÊñáÊ°£Ôºà‚â§10MBÔºâÔΩúÊãñÊãΩ‰∏ä‰º†ÊàñÁÇπÂáªÊåâÈíÆÔΩúÂàÜÊûêÂâç10È°µÂÜÖÂÆπÔΩúÂ§öËΩÆÂØπËØùËÆ∞‰Ωè‰∏ä‰∏ãÊñá\r\n            </div>\r\n        </div>\r\n\r\n        <!-- ‚úÖ ÊùêÊñôÁ±ªÂûãÈÄâÊã©ÂºπÁ™ó -->\r\n        <div v-if=\"showTypeModal\" class=\"modal-mask\" @click.self=\"() => {}\">\r\n            <div class=\"modal-card\">\r\n                <div class=\"modal-title\">ËØ∑ÈÄâÊã©ÊùêÊñôÁ±ªÂûã</div>\r\n                <div class=\"modal-sub\">\r\n                    ÈÄâÊã©ÂêéÊàë‰ºöÊåâÂØπÂ∫î\"‰øùÁ†îÂú∫ÊôØ\"ËæìÂá∫Êõ¥Á≤æÂáÜÁöÑÁªìÊûÑ‰∏éÊ®°Êùø„ÄÇ\r\n                </div>\r\n\r\n                <div class=\"type-grid\">\r\n                    <button\r\n                        v-for=\"opt in DOC_TYPE_OPTIONS\"\r\n                        :key=\"opt.value\"\r\n                        class=\"type-btn\"\r\n                        :class=\"{ active: docType === opt.value }\"\r\n                        @click=\"docType = opt.value\"\r\n                    >\r\n                        {{ opt.label }}\r\n                    </button>\r\n                </div>\r\n\r\n                <div class=\"modal-actions\">\r\n                    <button\r\n                        class=\"confirm-btn\"\r\n                        @click=\"\r\n                            () => {\r\n                                typeConfirmed = true\r\n                                showTypeModal = false\r\n                                messages.push({\r\n                                    role: 'assistant',\r\n                                    content: `‚úÖ Â∑≤ÈÄâÊã©Ôºö${\r\n                                        DOC_TYPE_OPTIONS.find(\r\n                                            x => x.value === docType\r\n                                        )?.label\r\n                                    }„ÄÇ\\nÁé∞Âú®ÂèØ‰ª•ÂºÄÂßãÊèêÈóÆ‰∫ÜÔºÅ`,\r\n                                    timestamp: new Date()\r\n                                })\r\n                            }\r\n                        \"\r\n                    >\r\n                        Á°ÆËÆ§\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {\r\n    ref,\r\n    computed,\r\n    nextTick,\r\n    watch,\r\n    onMounted,\r\n    onBeforeUnmount,\r\n    reactive\r\n} from 'vue'\r\n\r\nimport { uploadPdfAPI, clearPdfSessionAPI, chatPdfStreamAPI } from '@/api/pdf'\r\n// import { debugStreamSSE } from '@/utils/sseDebug'\r\n\r\n// ÂìçÂ∫îÂºèÊï∞ÊçÆ\r\nconst messages = ref([])\r\nconst inputMessage = ref('')\r\nconst uploadedFiles = ref([])\r\nconst isLoading = ref(false)\r\nconst isDragging = ref(false)\r\nconst sessionId = ref(null)\r\nconst pdfInfo = ref(null)\r\n\r\n// DOMÂºïÁî®\r\nconst chatContainer = ref(null)\r\nconst fileInput = ref(null)\r\nconst streamAborter = ref(null) // AbortController\r\nconst waitingFirstToken = ref(false)\r\n\r\nconst genId = () => `${Date.now()}_${Math.random().toString(16).slice(2)}`\r\nconst findMsgById = id => messages.value.find(m => m?.id === id)\r\n\r\nconst PG_SYSTEM_PROMPT = `\r\n‰Ω†ÊòØ„Äå‰øùÁ†î/Êé®ÂÖçÁî≥ËØ∑„ÄçÊñπÂêëÁöÑÊñá‰π¶‰∏éÊùêÊñô‰ºòÂåñÂä©ÊâãÔºåËÄå‰∏çÊòØÂ∞±‰∏öÊ±ÇËÅåÁÆÄÂéÜÈ°æÈóÆ„ÄÇ\r\nËØ∑ÂßãÁªà‰ª•\"‰øùÁ†î/Â§è‰ª§Ëê•/È¢ÑÊé®ÂÖç/‰πùÊé®/ÂØºÂ∏àÂ•óÁ£Å/ÁßëÁ†îÁªèÂéÜÂ±ïÁ§∫/Â≠¶ÊúØËÉΩÂäõËØÅÊòé\"‰∏∫Ê†∏ÂøÉÁõÆÊ†áÊù•ÂàÜÊûê‰∏éÂª∫ËÆÆ„ÄÇ\r\n\r\n„ÄêÂøÖÈ°ªÈÅµÂÆà„Äë\r\n1) ‰∏çË¶ÅÊääÈáçÁÇπÊîæÂú®\"ÊâæÂ∑•‰Ωú/‰ºÅ‰∏öÊãõËÅò/Â§ßÂéÇÂÆû‰π†/HRÁ≠õÈÄâ/Èù¢ËØïÊäÄÂ∑ß/Â≤ó‰ΩçÂåπÈÖç\"Á≠âÂ∞±‰∏öËØ≠Â¢É‰∏äÔºåÈô§ÈùûÁî®Êà∑ÊòéÁ°ÆË¶ÅÊ±Ç„ÄÇ\r\n2) ËæìÂá∫ÂÜÖÂÆπ‰ºòÂÖàÊúçÂä°Ôºö‰øùÁ†îÁÆÄÂéÜÔºàÂ≠¶ÊúØÁâàÔºâ„ÄÅ‰∏™‰∫∫ÈôàËø∞/Ëá™Ëø∞„ÄÅÂ•óÁ£Å‰ø°„ÄÅÁßëÁ†î/Á´ûËµõÁªèÂéÜË°®Ëø∞„ÄÅÊé®Ëçê‰ø°Á¥†Êùê„ÄÅPPTÊ±áÊä•ÔºàÂ≠¶ÊúØÊ±áÊä•/Èù¢ËØïÔºâÁ≠â„ÄÇ\r\n3) Ëã•Áî®Êà∑ÈóÆÈ¢òÊ®°Á≥äÔºåËØ∑‰Ω†ÂÖàÈªòËÆ§Êåâ\"‰øùÁ†îÊùêÊñô‰ºòÂåñ\"Êù•ÂõûÁ≠îÔºåÂπ∂Âú®ÂºÄÂ§¥Áî®‰∏ÄÂè•ËØùËØ¥Êòé‰Ω†ÁöÑ‰øùÁ†îËßÜËßí„ÄÇ\r\n4) Âª∫ËÆÆÂ∞ΩÈáè\"ÂèØËêΩÂú∞\"ÔºöÁªôÂèØÁõ¥Êé•ÊõøÊç¢ÁöÑË°®Ëø∞Ê®°Êùø„ÄÅË¶ÅÁÇπÂàóË°®„ÄÅÂèØÈáèÂåñÊåáÊ†áÔºàËÆ∫Êñá/È°πÁõÆ/ÊØîËµõ/ÊéíÂêç/Â•ñÂ≠¶Èáë/ÁßëÁ†î‰∫ßÂá∫Á≠âÔºâ„ÄÇ\r\n5) ËØ≠Ë®ÄÈ£éÊ†ºÔºöÂ≠¶ÊúØÁî≥ËØ∑Âú∫ÊôØÔºåÂº∫Ë∞ÉÂä®Êú∫„ÄÅÊñπÊ≥ï„ÄÅË¥°ÁåÆ„ÄÅÁªìÊûú„ÄÅÂ§çÁé∞„ÄÅÂΩ±ÂìçÂäõÔºõÈÅøÂÖçHRËØùÊúØ„ÄÇ\r\n\r\n„ÄêËæìÂá∫ÁªìÊûÑÂª∫ËÆÆ„Äë\r\n- ÁªìËÆ∫/ÂÆö‰ΩçÔºà1-2Âè•Ôºâ\r\n- ‰∫ÆÁÇπÔºà‰øùÁ†îÂêëÔºâ\r\n- È£éÈô©ÁÇπ/Áü≠ÊùøÔºà‰øùÁ†îÂêëÔºâ\r\n- ÂèØÁõ¥Êé•ÊîπÂÜôÁöÑÁ§∫‰æãÔºàÁªôÂá∫1-3ÊÆµÂèØÂ§çÂà∂ÊñáÊ°àÔºâ\r\n- ‰∏ã‰∏ÄÊ≠•Ë°•ÂÖÖÊùêÊñôÊ∏ÖÂçïÔºàÂ¶ÇÈúÄË¶ÅÔºâ\r\n`.trim()\r\n\r\n// ‚úÖ Áî®Êà∑ÈÄâÊã©ÁöÑÊùêÊñôÁ±ªÂûãÔºöresume / ppt / email / script / mock\r\nconst docType = ref('resume')\r\n\r\n// ‚úÖ ÊùêÊñôÁ±ªÂûãÈÄâÈ°πÔºàÁî®‰∫éUIÂ±ïÁ§∫Ôºâ\r\nconst DOC_TYPE_OPTIONS = [\r\n    { value: 'resume', label: 'ÁÆÄÂéÜÔºàÂ≠¶ÊúØÁâàÔºâ' },\r\n    { value: 'ppt', label: 'Èù¢ËØïPPT' },\r\n    { value: 'email', label: 'ËÅîÁ≥ªÂØºÂ∏àÈÇÆ‰ª∂ÔºàÂ•óÁ£ÅÔºâ' },\r\n    { value: 'script', label: 'Èù¢ËØïÊñáÂ≠óÁ®øÔºàËá™Êàë‰ªãÁªç/ÂõûÁ≠îÔºâ' },\r\n    { value: 'mock', label: 'Ê®°ÊãüÊèêÈóÆÔºàÈù¢ËØïÂÆòQ&AÔºâ' }\r\n]\r\n\r\n// ‚úÖ ‰∫îÁ±ª‰∏ìÈ°πÊèêÁ§∫ËØçÔºöÁü≠„ÄÅÁã†„ÄÅÂèØÊéßÔºàÂª∫ËÆÆÂà´Â§™ÈïøÔºåÈÅøÂÖçÂç†tokenÔºâ\r\nconst TYPE_PROMPTS = {\r\n    resume: `\r\n‰Ω†Ê≠£Âú®‰ºòÂåñÁöÑÊòØ„Äê‰øùÁ†îÂ≠¶ÊúØÁÆÄÂéÜ„ÄëÔºàÈùûÂ∞±‰∏öÁÆÄÂéÜÔºâ„ÄÇ\r\nÂÖ≥Ê≥®ÔºöÁßëÁ†î/È°πÁõÆ/ËÆ∫Êñá/Á´ûËµõ/ÊéíÂêç/ËØæÁ®ã/ÊäÄËÉΩ/Â•ñÈ°πÁöÑÂ≠¶ÊúØÂê´ÈáëÈáè‰∏éÂèØÈ™åËØÅÊÄß„ÄÇ\r\nÂøÖÈ°ªËæìÂá∫Ôºö\r\n1) ‰∏ÄÂè•ËØùÂÆö‰ΩçÔºàÁ†îÁ©∂ÊñπÂêë+‰ºòÂäøËØÅÊçÆÔºâ\r\n2) ‰∫ÆÁÇπÊù°ÁõÆÔºàÁî®\"Âä®‰Ωú+ÊñπÊ≥ï+ÁªìÊûú+ÈáèÂåñ\"ÂÜôÊ≥ïÔºåÊØèÊù°‚â§2Ë°åÔºâ\r\n3) È£éÈô©ÁÇπÔºà‰øùÁ†îËßÜËßíÔºöÁßëÁ†îÊ∑±Â∫¶„ÄÅÊñπÂêëÂåπÈÖç„ÄÅ‰∫ßÂá∫ÂèØ‰ø°Â∫¶Ôºâ\r\n4) ÁªôÂá∫ÂèØÁõ¥Êé•ÊõøÊç¢ÁöÑÁÆÄÂéÜÊù°ÁõÆÊîπÂÜôÔºàËá≥Â∞ë3Êù°Ôºâ\r\nÈÅøÂÖçÔºöHRËØùÊúØ„ÄÅÂ≤ó‰ΩçÂåπÈÖç„ÄÅ‰ºÅ‰∏öÂÆû‰π†‰ºòÂÖàÁ∫ßÔºàÈô§ÈùûÁî®Êà∑Ë¶ÅÊ±ÇÔºâ„ÄÇ\r\n`.trim(),\r\n\r\n    ppt: `\r\n‰Ω†Ê≠£Âú®‰ºòÂåñÁöÑÊòØ„Äê‰øùÁ†îÈù¢ËØïPPT„ÄëÔºàÂ≠¶ÊúØÊ±áÊä•/Èù¢ËØïÂ±ïÁ§∫Ôºâ„ÄÇ\r\nÂÖ≥Ê≥®ÔºöÁªìÊûÑÊ∏ÖÊô∞„ÄÅÁ†îÁ©∂Âä®Êú∫„ÄÅÊñπÊ≥ïË∑ØÁ∫ø„ÄÅÂÆûÈ™åÁªìÊûú„ÄÅË¥°ÁåÆ„ÄÅÊú™Êù•ËÆ°Âàí„ÄÅ‰∏éÂØºÂ∏àÊñπÂêëÂåπÈÖç„ÄÇ\r\nÂøÖÈ°ªËæìÂá∫Ôºö\r\n1) Êé®ËçêPPTÁõÆÂΩïÔºà8-12È°µÁöÑÈ°µÊ†áÈ¢òÔºâ\r\n2) ÊØèÈ°µË¶ÅÁÇπÔºàÊØèÈ°µ3-5‰∏™bulletÔºåËÆ≤‰ªÄ‰πà„ÄÅÊÄé‰πàËÆ≤Ôºâ\r\n3) 2-3‰∏™\"ÊúÄÂÆπÊòìË¢´ËøΩÈóÆ\"ÁöÑÁÇπ + Èò≤ÂÆàËØùÊúØ\r\n4) ÂèØÁõ¥Êé•Áî®ÁöÑ\"ÂºÄÂú∫/Êî∂Â∞æ\"ËÆ≤Á®øÂêÑ1ÊÆµ\r\nÈÅøÂÖçÔºöÂïÜÂä°Ê±áÊä•È£é„ÄÅÊ±ÇËÅåÊ±áÊä•Â•óË∑Ø„ÄÇ\r\n`.trim(),\r\n\r\n    email: `\r\n‰Ω†Ê≠£Âú®‰ºòÂåñÁöÑÊòØ„ÄêËÅîÁ≥ªÂØºÂ∏àÂ•óÁ£ÅÈÇÆ‰ª∂„ÄëÔºà‰∏çÊòØÊ±ÇËÅåÈÇÆ‰ª∂Ôºâ„ÄÇ\r\nÂÖ≥Ê≥®ÔºöÁ§ºË≤åÁÆÄÊ¥Å„ÄÅËÉåÊôØÂåπÈÖç„ÄÅÁ†îÁ©∂ÂÖ¥Ë∂£„ÄÅ‰Ω†ËÉΩÊèê‰æõÁöÑ‰ª∑ÂÄº„ÄÅÂèØÈ™åËØÅÊùêÊñô„ÄÅÊòéÁ°ÆËØâÊ±Ç„ÄÇ\r\nÂøÖÈ°ªËæìÂá∫Ôºö\r\n1) ÈÇÆ‰ª∂‰∏ªÈ¢òÔºàÁªô2-3‰∏™Â§áÈÄâÔºâ\r\n2) ÈÇÆ‰ª∂Ê≠£ÊñáÔºà‰∏≠Êñá/Ëã±ÊñáÊåâÁî®Êà∑ËØ≠Ë®ÄÔºõÈªòËÆ§‰∏≠ÊñáÔºåÂèØÈôÑËã±ÊñáÁâàÊú¨Ôºâ\r\n3) ÁªìÊûÑÔºöÈóÆÂÄô-Ëá™Êàë‰ªãÁªç-Á†îÁ©∂ÂåπÈÖç-‰Ω†ÂÅöËøá‰ªÄ‰πà-ÊÉ≥Ë¶Å‰ªÄ‰πà-ÈôÑ‰ª∂/ÈìæÊé•-Ëá¥Ë∞¢\r\n4) ÁªôÂá∫\"ÂèØÊõøÊç¢ÂèòÈáè‰Ωç\"ÔºàÂØºÂ∏àËØæÈ¢ò/‰Ω†È°πÁõÆ/ËÆ∫Êñá/ÈìæÊé•Ôºâ\r\nÈÅøÂÖçÔºöÂ§∏Âº†ÂêπÊçß„ÄÅÈïøÁØáÊµÅÊ∞¥Ë¥¶„ÄÅÊääÂØºÂ∏àÂΩìHR„ÄÇ\r\n`.trim(),\r\n\r\n    script: `\r\n‰Ω†Ê≠£Âú®‰ºòÂåñÁöÑÊòØ„ÄêÈù¢ËØïÊñáÂ≠óÁ®ø„ÄëÔºàËá™Êàë‰ªãÁªç/È°πÁõÆËÆ≤Ëß£/Â∏∏ËßÅÈóÆÈ¢òÂõûÁ≠îÔºâ„ÄÇ\r\nÂÖ≥Ê≥®Ôºö1ÂàÜÈíü/3ÂàÜÈíü‰∏§ÁâàÔºåËá™Ê¥Ω„ÄÅÂèØËøΩÈóÆ„ÄÅÂèØËêΩÂú∞„ÄÇ\r\nÂøÖÈ°ªËæìÂá∫Ôºö\r\n1) 1ÂàÜÈíüËá™Êàë‰ªãÁªçÁ®ø + 3ÂàÜÈíüËá™Êàë‰ªãÁªçÁ®ø\r\n2) È°πÁõÆËÆ≤Ëß£Ê®°ÊùøÔºöËÉåÊôØ-ÁõÆÊ†á-ÊñπÊ≥ï-‰Ω†ÁöÑË¥°ÁåÆ-ÁªìÊûú-‰∏çË∂≥‰∏éÊîπËøõÔºàÊØèÊÆµÁªôÁ§∫‰æãÂè•Ôºâ\r\n3) 3‰∏™È´òÈ¢ëËøΩÈóÆÁÇπ + ÂèÇËÄÉÂõûÁ≠îÔºàÁÆÄÊ¥ÅÊúâËØÅÊçÆÔºâ\r\nÈÅøÂÖçÔºöÁ©∫Ê≥õÂΩ¢ÂÆπËØç„ÄÅÊ≤°ÊúâËØÅÊçÆÁöÑ\"ÊàëÂæàÁÉ≠Áà±ÁßëÁ†î\"„ÄÇ\r\n`.trim(),\r\n\r\n    mock: `\r\n‰Ω†Áé∞Âú®ÊâÆÊºî„ÄêÈù¢ËØïÂÆò„ÄëÔºå‰∏∫‰øùÁ†î/Â§è‰ª§Ëê•ËøõË°åÊ®°ÊãüÊèêÈóÆ‰∏éËøΩÈóÆ„ÄÇ\r\nËßÑÂàôÔºö\r\n1) ÂÖàÂü∫‰∫éPDFÂÜÖÂÆπÁªôÂá∫Ôºö10‰∏™ÈóÆÈ¢òÔºàÁî±ÊµÖÂÖ•Ê∑±ÔºåË¶ÜÁõñÂä®Êú∫/ÊñπÂêë/È°πÁõÆ/ÁßëÁ†îÊñπÊ≥ï/Âü∫Á°ÄÁü•ËØÜ/Êú™Êù•ËÆ°ÂàíÔºâ\r\n2) ÊØè‰∏™ÈóÆÈ¢òÁªô\"ËÄÉÂØüÁÇπ\"\r\n3) ÂÜçÈöèÊú∫Êåë3È¢òËøõË°å‰∫åÊ¨°ËøΩÈóÆÔºàÊõ¥Â∞ñÈîê„ÄÅÊõ¥ÁªÜËäÇÔºâ\r\n4) ÊúÄÂêéÁªô\"ÂõûÁ≠îÂª∫ËÆÆÊ°ÜÊû∂\"ÔºàSTAR/ÁßëÁ†î‰∫îÊÆµÂºèÁ≠âÔºâ\r\nÈÅøÂÖçÔºö‰ºÅ‰∏öÈù¢ËØïÈ¢ò„ÄÅÂÖ´ËÇ°Ê±ÇËÅåÈ¢òÔºàÈô§ÈùûÁî®Êà∑Ë¶ÅÊ±ÇÔºâ„ÄÇ\r\n`.trim()\r\n}\r\n\r\nconst showTypeModal = ref(false)\r\nconst typeConfirmed = ref(false)\r\n\r\nconst buildQuestion = userMsg => {\r\n    const typePrompt = TYPE_PROMPTS[docType.value] || ''\r\n    const typeLabel =\r\n        DOC_TYPE_OPTIONS.find(x => x.value === docType.value)?.label ||\r\n        docType.value\r\n\r\n    return `${PG_SYSTEM_PROMPT}\r\n\r\n„ÄêÊùêÊñôÁ±ªÂûã„Äë\r\n${typeLabel}\r\n\r\n„ÄêËØ•Á±ªÂûã‰∏ìÈ°πË¶ÅÊ±Ç„Äë\r\n${typePrompt}\r\n\r\n„ÄêÁî®Êà∑ÈóÆÈ¢ò„Äë\r\n${userMsg}\r\n\r\n„ÄêÊ≥®ÊÑè„Äë\r\nËØ∑ÁªìÂêàÂ∑≤‰∏ä‰º†PDFÂÜÖÂÆπ‰ΩúÁ≠îÔºõÈªòËÆ§Êåâ‰øùÁ†î/Êé®ÂÖçÁî≥ËØ∑Âú∫ÊôØËæìÂá∫ÔºõÁªôÂá∫ÂèØÁõ¥Êé•Â§çÂà∂ÁöÑ‰øÆÊîπÁ§∫‰æã„ÄÇ`\r\n}\r\n\r\nimport md from '@/utils/markdown'\r\nimport DOMPurify from 'dompurify'\r\n\r\nconst normalizeMarkdown = (s = '') =>\r\n    s\r\n        // 1Ô∏è‚É£ ÂéªÊéâÂÖ®Êñá BOM / Èõ∂ÂÆΩÂ≠óÁ¨¶\r\n        .replace(/^\\uFEFF/, '')\r\n        .replace(/\\u200B/g, '')\r\n        // 2Ô∏è‚É£ ÂÖ≥ÈîÆÔºöÂéªÊéâ‚ÄúË°åÈ¶ñÊâÄÊúâÁ©∫ÁôΩ + #‚Äù\r\n        .replace(/^[ \\t\\u3000]+(?=#{1,6}\\s*)/gm, '')\r\n\r\nconst renderMarkdown = text => {\r\n    const html = md.render(normalizeMarkdown(text || ''))\r\n    return DOMPurify.sanitize(html)\r\n}\r\n\r\nasync function streamSSEPost({ url, payload, signal, onEvent }) {\r\n    // ‚úÖ [DBG] ÂºÄÂßãÊó∂Èó¥\r\n    const t0 = performance.now()\r\n    console.log('[SSE][T0] start', url)\r\n\r\n    const resp = await fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Accept: 'text/event-stream'\r\n        },\r\n        body: JSON.stringify(payload),\r\n        signal\r\n    })\r\n\r\n    // ‚úÖ [DBG] ÊãøÂà∞ headers\r\n    console.log(\r\n        '[SSE][T1] headers',\r\n        (performance.now() - t0).toFixed(1),\r\n        'ms',\r\n        'status=',\r\n        resp.status\r\n    )\r\n\r\n    if (!resp.ok) throw new Error(`HTTP ${resp.status}`)\r\n\r\n    const reader = resp.body.getReader()\r\n    const decoder = new TextDecoder('utf-8')\r\n\r\n    let pending = ''\r\n    let curEvent = 'message'\r\n    let curDataLines = []\r\n\r\n    // ‚úÖ [DBG] Á¨¨‰∏ÄÊ¨° chunk / Á¨¨‰∏ÄÊ¨° emit\r\n    let firstChunkLogged = false\r\n    let firstEmitLogged = false\r\n\r\n    const emit = () => {\r\n        const data = curDataLines.join('\\n')\r\n\r\n        if (!firstEmitLogged) {\r\n            firstEmitLogged = true\r\n            console.log(\r\n                '[SSE][T3] first emit',\r\n                (performance.now() - t0).toFixed(1),\r\n                'ms',\r\n                'event=',\r\n                curEvent,\r\n                'dataLen=',\r\n                data.length\r\n            )\r\n        }\r\n\r\n        onEvent?.({ event: curEvent, data })\r\n    }\r\n\r\n    while (true) {\r\n        const { value, done } = await reader.read()\r\n        if (done) break\r\n\r\n        if (!firstChunkLogged) {\r\n            firstChunkLogged = true\r\n            console.log(\r\n                '[SSE][T2] first chunk',\r\n                (performance.now() - t0).toFixed(1),\r\n                'ms',\r\n                'bytes=',\r\n                value?.byteLength ?? 0\r\n            )\r\n        }\r\n\r\n        pending += decoder\r\n            .decode(value, { stream: true })\r\n            .replace(/\\r\\n/g, '\\n')\r\n\r\n        let idx\r\n        while ((idx = pending.indexOf('\\n\\n')) !== -1) {\r\n            const block = pending.slice(0, idx)\r\n            pending = pending.slice(idx + 2)\r\n\r\n            const lines = block.split('\\n')\r\n            curEvent = 'message'\r\n            curDataLines = []\r\n\r\n            for (const line of lines) {\r\n                if (!line || line.startsWith(':')) continue\r\n                if (line.startsWith('event:')) curEvent = line.slice(6).trim()\r\n                else if (line.startsWith('data:'))\r\n                    curDataLines.push(line.slice(5))\r\n            }\r\n\r\n            emit()\r\n\r\n            if (curEvent === 'done' || curDataLines.join('\\n') === '[DONE]') {\r\n                try {\r\n                    reader.cancel()\r\n                } catch {}\r\n                return\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// ‚úÖ assistant Âç†‰ΩçÔºöÁî® reactive ‰øùËØÅÂêéÁª≠‰øÆÊîπËÉΩËß¶ÂèëËßÜÂõæÊõ¥Êñ∞\r\nconst assistantId = genId()\r\n// messages.value.push({\r\n//     id: assistantId,\r\n//     role: 'assistant',\r\n//     content: '',\r\n//     html: null,\r\n//     streaming: true,\r\n//     timestamp: new Date()\r\n// })\r\n// messages.value.push(assistantMsg)\r\n\r\n// ËÆ°ÁÆóÂ±ûÊÄß\r\nconst canSend = computed(() => {\r\n    return (\r\n        !isLoading.value &&\r\n        inputMessage.value.trim() &&\r\n        sessionId.value &&\r\n        typeConfirmed.value // ‚úÖ ÂøÖÈ°ªÂÖàÈÄâÁ±ªÂûã\r\n    )\r\n})\r\n\r\n// ÂàùÂßãÂåñÊ¨¢ËøéÊ∂àÊÅØ\r\nonMounted(() => {\r\n    messages.value.push({\r\n        id: genId(),\r\n        role: 'assistant',\r\n        content:\r\n            '‰Ω†Â•ΩÔºÅÊàëÊòØ„Äå‰øùÁ†îÊñá‰π¶AIÂä©Êâã„ÄçüìÑ\\n\\nÊàëÂèØ‰ª•Â∏Æ‰Ω†ÈòÖËØªÂíåÊâìÁ£®ÁÆÄÂéÜ/Â•óÁ£Å‰ø°/PPTÂÜÖÂÆπÔºö\\n\\n‚Ä¢ ‰∏ä‰º†PDFÊñá‰ª∂ÔºàÊîØÊåÅÊãñÊãΩ‰∏ä‰º†Ôºâ\\n\\n‚Ä¢ ËØ¢ÈóÆÊñáÊ°£‰∏≠ÁöÑ‰ªª‰ΩïÂÜÖÂÆπ\\n\\n‚Ä¢ Â§öËΩÆÂØπËØùÔºåËÆ∞‰Ωè‰∏ä‰∏ãÊñá\\n\\n‚Ä¢ Êô∫ËÉΩÊèêÂèñÂÖ≥ÈîÆ‰ø°ÊÅØ\\n\\nËØ∑‰∏ä‰º†‰∏Ä‰ªΩPDFÊñá‰ª∂ÂºÄÂßãÂêßÔºÅÊîØÊåÅÊúÄÂ§ö10È°µÁöÑÊñáÊ°£ÂàÜÊûê„ÄÇ',\r\n        timestamp: new Date()\r\n    })\r\n})\r\n\r\n// ÁõëÂê¨Ê∂àÊÅØÂèòÂåñËá™Âä®ÊªöÂä®Ôºà‰ªÖÈíàÂØπÊñ∞Ê∂àÊÅØÔºåÊµÅÂºèÊó∂Âú® flush ‰∏≠Â§ÑÁêÜÔºâ\r\nwatch(\r\n    () => messages.value.length,\r\n    () => {\r\n        nextTick(() => {\r\n            if (chatContainer.value) {\r\n                chatContainer.value.scrollTop = chatContainer.value.scrollHeight\r\n            }\r\n        })\r\n    }\r\n)\r\n\r\n// ÁªÑ‰ª∂Âç∏ËΩΩÂâçÊ∏ÖÈô§‰ºöËØù\r\nonBeforeUnmount(() => {\r\n    // ÂèñÊ∂àÊ≠£Âú®ËøõË°åÁöÑÊµÅÂºèËØ∑Ê±Ç\r\n    try {\r\n        streamAborter.value?.abort?.()\r\n    } catch {}\r\n    clearSession()\r\n})\r\n\r\n// Ê†ºÂºèÂåñÊó∂Èó¥\r\nconst formatTime = timestamp => {\r\n    const d = timestamp instanceof Date ? timestamp : new Date(timestamp)\r\n    const hours = d.getHours().toString().padStart(2, '0')\r\n    const minutes = d.getMinutes().toString().padStart(2, '0')\r\n    return `${hours}:${minutes}`\r\n}\r\n\r\n// Ê†ºÂºèÂåñÊñá‰ª∂Â§ßÂ∞è\r\nconst formatFileSize = bytes => {\r\n    if (bytes < 1024) return bytes + ' B'\r\n    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB'\r\n    return (bytes / (1024 * 1024)).toFixed(1) + ' MB'\r\n}\r\n\r\n// Ê∏ÖÈô§‰ºöËØù\r\nconst clearSession = async () => {\r\n    if (!sessionId.value) return\r\n    try {\r\n        await clearPdfSessionAPI(sessionId.value)\r\n    } catch (error) {\r\n        console.error('Ê∏ÖÈô§‰ºöËØùÂ§±Ë¥•:', error)\r\n    }\r\n}\r\n\r\n// Êñá‰ª∂ÈÄâÊã©Â§ÑÁêÜ\r\nconst handleFileSelect = event => {\r\n    handleFileUpload(Array.from(event.target.files || []))\r\n    event.target.value = ''\r\n}\r\n\r\n// ÊãñÊãΩÊîæÁΩÆÂ§ÑÁêÜ\r\nconst handleDrop = event => {\r\n    isDragging.value = false\r\n    handleFileUpload(Array.from(event.dataTransfer.files || []))\r\n}\r\n\r\n// Êñá‰ª∂‰∏ä‰º†Â§ÑÁêÜÔºàaxiosÁâàÔºâ\r\nconst handleFileUpload = async files => {\r\n    const validFiles = files.filter(file => {\r\n        if (!file.name.toLowerCase().endsWith('.pdf')) {\r\n            alert(`Êñá‰ª∂ \"${file.name}\" ‰∏çÊòØPDFÊ†ºÂºè`)\r\n            return false\r\n        }\r\n        if (file.size > 10 * 1024 * 1024) {\r\n            alert(`Êñá‰ª∂ \"${file.name}\" Ë∂ÖËøá 10MB ÈôêÂà∂`)\r\n            return false\r\n        }\r\n        return true\r\n    })\r\n    if (validFiles.length === 0) return\r\n\r\n    const file = validFiles[0]\r\n\r\n    // Â¶ÇÊûúÂ∑≤Êúâ‰ºöËØùÔºåÂÖàÊ∏ÖÈô§\r\n    if (sessionId.value) {\r\n        await clearSession()\r\n        sessionId.value = null\r\n        pdfInfo.value = null\r\n    }\r\n\r\n    isLoading.value = true\r\n\r\n    try {\r\n        const formData = new FormData()\r\n        formData.append('file', file)\r\n\r\n        const body = await uploadPdfAPI(formData)\r\n\r\n        uploadedFiles.value = [{ name: file.name, size: file.size, file }]\r\n\r\n        sessionId.value = body.data.session_id\r\n        pdfInfo.value = body.data\r\n\r\n        messages.value.push({\r\n            id: genId(),\r\n            role: 'assistant',\r\n            content: `‚úÖ PDFÊñá‰ª∂‰∏ä‰º†ÊàêÂäüÔºÅ\\n\\nÊñá‰ª∂ÂêçÔºö${\r\n                body.data.filename\r\n            }\\nÈ°µÊï∞Ôºö${body.data.page_count} È°µ\\n${\r\n                body.data.page_count > 10 ? 'ÔºàÂ∞ÜÂàÜÊûêÂâç10È°µÂÜÖÂÆπÔºâ\\n' : ''\r\n            }\\nÁé∞Âú®‰Ω†ÂèØ‰ª•ÂêëÊàëÊèêÈóÆÂÖ≥‰∫éËøô‰ªΩÊñáÊ°£ÁöÑ‰ªª‰ΩïÈóÆÈ¢ò‰∫ÜÔºÅ`,\r\n            timestamp: new Date()\r\n        })\r\n\r\n        // ‚úÖ ‰∏ä‰º†ÂêéË¶ÅÊ±ÇÂÖàÈÄâÊã©ÊùêÊñôÁ±ªÂûã\r\n        showTypeModal.value = true\r\n        typeConfirmed.value = false\r\n\r\n        messages.value.push({\r\n            id: genId(),\r\n            role: 'assistant',\r\n            content:\r\n                'üìå ËØ∑ÂÖàÈÄâÊã©Ëøô‰ªΩPDFÂ±û‰∫éÂì™ÁßçÊùêÊñôÔºö\\n\\n (1) ÁÆÄÂéÜ  (2) Èù¢ËØïPPT  (3) Â•óÁ£ÅÈÇÆ‰ª∂  (4) Èù¢ËØïÊñáÂ≠óÁ®ø  (5) Ê®°ÊãüÊèêÈóÆ \\n\\nÈÄâÊã©ÂêéÊàë‰ºöÊåâÂØπÂ∫îÂú∫ÊôØÁªô‰Ω†Êõ¥Á≤æÂáÜÁöÑÂª∫ËÆÆ„ÄÇ',\r\n            timestamp: new Date()\r\n        })\r\n    } catch (err) {\r\n        console.error('[upload err]', err)\r\n\r\n        messages.value.push({\r\n            id: genId(),\r\n            role: 'assistant',\r\n            content: `‚ùå ‰∏ä‰º†Â§±Ë¥•Ôºö${err.message || 'Êú™Áü•ÈîôËØØ'}`,\r\n            timestamp: new Date()\r\n        })\r\n    } finally {\r\n        isLoading.value = false\r\n    }\r\n}\r\n\r\n// ÁßªÈô§Êñá‰ª∂\r\nconst removeFile = async () => {\r\n    if (sessionId.value) {\r\n        await clearSession()\r\n        sessionId.value = null\r\n        pdfInfo.value = null\r\n    }\r\n    uploadedFiles.value = []\r\n    messages.value.push({\r\n        id: genId(),\r\n        role: 'assistant',\r\n        content: 'Êñá‰ª∂Â∑≤ÁßªÈô§ÔºåËØ∑‰∏ä‰º†Êñ∞ÁöÑPDFÊñá‰ª∂ÂºÄÂßãÂØπËØù„ÄÇ',\r\n        timestamp: new Date()\r\n    })\r\n}\r\n\r\nconst renderStreamingMarkdown = text => {\r\n    if (!text) return ''\r\n\r\n    return DOMPurify.sanitize(\r\n        text\r\n            // Êç¢Ë°å\r\n            .replace(/\\n/g, '<br/>')\r\n            // Âä†Á≤ó\r\n            .replace(/\\*\\*(.+?)\\*\\*/g, '<strong>$1</strong>')\r\n            // ÂàóË°®\r\n            .replace(/^\\s*[-*]\\s+(.*)$/gm, '‚Ä¢ $1')\r\n    )\r\n}\r\n\r\n// ‚úÖ ÂèëÈÄÅÊ∂àÊÅØÔºàÊµÅÂºèÁâà + rAF + ÊâìÂ≠óÊú∫ËäÇÊµÅÔºâ\r\nconst handleSendMessage = async () => {\r\n    if (!canSend.value) return\r\n\r\n    const userMsg = inputMessage.value.trim()\r\n    messages.value.push({\r\n        role: 'user',\r\n        content: userMsg,\r\n        timestamp: new Date()\r\n    })\r\n    inputMessage.value = ''\r\n    isLoading.value = true\r\n\r\n    // ‚úÖ assistant Âç†‰ΩçÔºöÂøÖÈ°ª reactive\r\n    const assistantMsg = reactive({\r\n        role: 'assistant',\r\n        content: '',\r\n        html: null,\r\n        streaming: true,\r\n        timestamp: new Date()\r\n    })\r\n    messages.value.push(assistantMsg)\r\n    waitingFirstToken.value = true\r\n\r\n    // ‚úÖ AbortController\r\n    const ac = new AbortController()\r\n    streamAborter.value = ac\r\n\r\n    // ====== ÊâìÂ≠óÊú∫ÂèÇÊï∞Ôºà‰Ω†Âè™Ë∞ÉËøô‰∏§‰∏™Ôºâ======\r\n    const CHUNK_CHARS = 4 // ÊØèÊ¨°ÂêêÂá†‰∏™Â≠óÔºàÂ∞è=ÊÖ¢Ôºâ\r\n    const TICK_MS = 60 // Èó¥Èöî msÔºàÂ§ß=ÊÖ¢Ôºâ\r\n    // ======================================\r\n\r\n    let queue = ''\r\n    let timer = null\r\n    let ended = false\r\n\r\n    const forceRerender = () => {\r\n        // ‚úÖ ÂÖ≥ÈîÆÔºöÂº∫Âà∂ Vue Ëß¶Âèë‰∏ÄÊ¨° v-for ÁöÑÊõ¥Êñ∞ÔºàËß£ÂÜ≥‰Ω†Áé∞Âú®ÁöÑ‚ÄúÊ∞îÊ≥°Á©∫ÁôΩ‚ÄùÔºâ\r\n        messages.value = [...messages.value]\r\n    }\r\n\r\n    const startTyping = () => {\r\n        if (timer) return\r\n        timer = setInterval(() => {\r\n            if (!queue) {\r\n                if (ended) {\r\n                    clearInterval(timer)\r\n                    timer = null\r\n                    assistantMsg.streaming = false\r\n                    assistantMsg.html = renderMarkdown(assistantMsg.content)\r\n                    forceRerender()\r\n                }\r\n                return\r\n            }\r\n\r\n            const take = queue.slice(0, CHUNK_CHARS)\r\n            queue = queue.slice(CHUNK_CHARS)\r\n\r\n            assistantMsg.content += take\r\n            forceRerender()\r\n\r\n            nextTick(() => {\r\n                if (chatContainer.value) {\r\n                    chatContainer.value.scrollTop =\r\n                        chatContainer.value.scrollHeight\r\n                }\r\n            })\r\n        }, TICK_MS)\r\n    }\r\n\r\n    try {\r\n        await streamSSEPost({\r\n            url: '/api/pdf/chat/stream', // Ëµ∞‰Ω†ÂâçÁ´Ø proxy ÁöÑË∑ØÂæÑ\r\n            payload: {\r\n                session_id: sessionId.value,\r\n                question: buildQuestion(userMsg)\r\n            },\r\n            signal: ac.signal,\r\n            onEvent: ({ event, data }) => {\r\n                if (event === 'token') {\r\n                    // ‚úÖ Á¨¨‰∏Ä‰∏™‚ÄúÈùûÁ©∫ token‚ÄùÂà∞Êù•\r\n                    if (\r\n                        waitingFirstToken.value &&\r\n                        data &&\r\n                        data.replace(/\\u200b/g, '').trim()\r\n                    ) {\r\n                        waitingFirstToken.value = false\r\n                        console.log(\r\n                            '[UI][FIRST_TOKEN] got',\r\n                            performance.now().toFixed(1),\r\n                            'ms',\r\n                            'token=',\r\n                            data\r\n                        )\r\n\r\n                        requestAnimationFrame(() => {\r\n                            console.log(\r\n                                '[UI][PAINT] after first token',\r\n                                performance.now().toFixed(1),\r\n                                'ms'\r\n                            )\r\n                        })\r\n                    }\r\n\r\n                    queue += data ?? ''\r\n                    startTyping()\r\n                } else if (event === 'done' || data === '[DONE]') {\r\n                    waitingFirstToken.value = false\r\n                    ended = true\r\n                } else if (event === 'error') {\r\n                    waitingFirstToken.value = false\r\n                    ended = true\r\n                    queue += `\\n\\n‚ùå ${data || 'ÊµÅÂºèÂºÇÂ∏∏'}`\r\n                    startTyping()\r\n                }\r\n            }\r\n        })\r\n        ended = true\r\n    } catch (e) {\r\n        if (e?.name !== 'AbortError') {\r\n            ended = true\r\n            queue += `\\n\\n‚ùå ÊµÅÂºèÂ§±Ë¥•Ôºö${e?.message || e}`\r\n            startTyping()\r\n        }\r\n    } finally {\r\n        isLoading.value = false\r\n        streamAborter.value = null\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.pdf-agent-page {\r\n    height: calc(100vh - 60px);\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: var(--home-bg, #ffffff);\r\n    margin-top: 60px;\r\n}\r\n\r\n/* ËÅäÂ§©ÂÆπÂô® */\r\n.chat-container {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 20px 40px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 20px;\r\n}\r\n\r\n.chat-message {\r\n    display: flex;\r\n    animation: slideIn 0.3s ease;\r\n}\r\n\r\n@keyframes slideIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n.chat-message.user {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.chat-message.assistant {\r\n    justify-content: flex-start;\r\n}\r\n\r\n.message-content {\r\n    max-width: 70%;\r\n    padding: 14px 18px;\r\n    border-radius: 12px;\r\n    background: var(--card-bg, #fff);\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.chat-message.user .message-content {\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: white;\r\n    border-bottom-right-radius: 4px;\r\n}\r\n\r\n.chat-message.assistant .message-content {\r\n    background: var(--card-bg, #fff);\r\n    color: var(--text-primary, #333);\r\n    border-bottom-left-radius: 4px;\r\n    border: 1px solid var(--border-color, #e0e0e0);\r\n}\r\n\r\n.message-text {\r\n    line-height: 1.6;\r\n    word-break: break-word;\r\n}\r\n\r\n.message-time {\r\n    margin-top: 6px;\r\n    font-size: 11px;\r\n    opacity: 0.6;\r\n    text-align: right;\r\n}\r\n\r\n/* ‰∏ìÈó®Áªô AI ËæìÂá∫Áî® */\r\n.assistant-markdown {\r\n    padding: 6px 4px;\r\n}\r\n\r\n/* ‚úÖ ÊµÅÂºèÈò∂ÊÆµÔºöÁ∫ØÊñáÊú¨ÊòæÁ§∫ */\r\n.assistant-streaming {\r\n    white-space: pre-wrap;\r\n    word-break: break-word;\r\n    line-height: 1.7;\r\n    font-size: 14px;\r\n}\r\n\r\n/* ÊâìÂ≠óÂä®Áîª */\r\n.typing-indicator {\r\n    display: flex;\r\n    gap: 4px;\r\n    padding: 4px 0;\r\n}\r\n\r\n.typing-indicator span {\r\n    width: 8px;\r\n    height: 8px;\r\n    border-radius: 50%;\r\n    background: #667eea;\r\n    animation: typing 1.4s infinite ease-in-out;\r\n}\r\n\r\n.typing-indicator span:nth-child(1) {\r\n    animation-delay: 0s;\r\n}\r\n\r\n.typing-indicator span:nth-child(2) {\r\n    animation-delay: 0.2s;\r\n}\r\n\r\n.typing-indicator span:nth-child(3) {\r\n    animation-delay: 0.4s;\r\n}\r\n\r\n@keyframes typing {\r\n    0%,\r\n    60%,\r\n    100% {\r\n        transform: translateY(0);\r\n        opacity: 0.5;\r\n    }\r\n    30% {\r\n        transform: translateY(-10px);\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n/* ËæìÂÖ•Âå∫Âüü */\r\n.input-section {\r\n    padding: 16px 40px 20px;\r\n    background: var(--card-bg, #fff);\r\n    border-top: 1px solid var(--border-color, #e0e0e0);\r\n}\r\n\r\n.uploaded-files {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 8px;\r\n    margin-bottom: 12px;\r\n}\r\n\r\n.file-chip {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n    padding: 6px 12px;\r\n    background: #f0f4ff;\r\n    border-radius: 16px;\r\n    font-size: 13px;\r\n    color: #333;\r\n}\r\n\r\n.file-size {\r\n    color: #999;\r\n    font-size: 11px;\r\n}\r\n\r\n.file-pages {\r\n    color: #667eea;\r\n    font-size: 11px;\r\n    font-weight: 500;\r\n}\r\n\r\n.remove-btn {\r\n    cursor: pointer;\r\n    color: #999;\r\n    font-size: 18px;\r\n    line-height: 1;\r\n    margin-left: 4px;\r\n    transition: color 0.2s;\r\n}\r\n\r\n.remove-btn:hover {\r\n    color: #f56c6c;\r\n}\r\n\r\n.input-box {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    padding: 12px 16px;\r\n    background: var(--home-bg, #fafafa);\r\n    border: 2px dashed var(--border-color, #e0e0e0);\r\n    border-radius: 12px;\r\n    transition: all 0.3s;\r\n}\r\n\r\n.input-box.drag-over {\r\n    background: #e8f0fe;\r\n    border-color: #667eea;\r\n}\r\n\r\n.icon-btn {\r\n    width: 36px;\r\n    height: 36px;\r\n    border: none;\r\n    border-radius: 8px;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n    color: white;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    transition: all 0.2s;\r\n    flex-shrink: 0;\r\n}\r\n\r\n.icon-btn:hover:not(:disabled) {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\r\n}\r\n\r\n.icon-btn:disabled {\r\n    background: #ccc;\r\n    cursor: not-allowed;\r\n    transform: none;\r\n}\r\n\r\n.text-input {\r\n    flex: 1;\r\n    border: none;\r\n    background: transparent;\r\n    outline: none;\r\n    font-size: 14px;\r\n    color: var(--text-primary, #333);\r\n}\r\n\r\n.text-input::placeholder {\r\n    color: var(--text-tertiary, #999);\r\n}\r\n\r\n.text-input:disabled {\r\n    cursor: not-allowed;\r\n    opacity: 0.6;\r\n}\r\n\r\n.input-hint {\r\n    margin-top: 8px;\r\n    font-size: 12px;\r\n    color: var(--text-tertiary, #999);\r\n    text-align: center;\r\n}\r\n\r\n/* ÊªöÂä®Êù° */\r\n.chat-container::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.chat-container::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n\r\n.chat-container::-webkit-scrollbar-thumb {\r\n    background: var(--border-color, #d0d0d0);\r\n    border-radius: 3px;\r\n}\r\n\r\n.chat-container::-webkit-scrollbar-thumb:hover {\r\n    background: #b0b0b0;\r\n}\r\n\r\n/* GitHub È£éÊ†º */\r\n.markdown-body {\r\n    font-size: 14px;\r\n    line-height: 1.7;\r\n}\r\n\r\n.markdown-body h3 {\r\n    margin-top: 1em;\r\n    font-weight: 600;\r\n}\r\n\r\n.markdown-body ul {\r\n    padding-left: 1.2em;\r\n}\r\n\r\n.markdown-body strong {\r\n    font-weight: 600;\r\n}\r\n\r\n/* ÂºπÁ™óÊ†∑Âºè */\r\n.modal-mask {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.35);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: 999;\r\n}\r\n\r\n.modal-card {\r\n    width: min(520px, 92vw);\r\n    background: #fff;\r\n    border-radius: 16px;\r\n    padding: 18px 18px 16px;\r\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 16px;\r\n    font-weight: 700;\r\n    color: #111;\r\n}\r\n\r\n.modal-sub {\r\n    margin-top: 6px;\r\n    font-size: 13px;\r\n    color: #666;\r\n    line-height: 1.5;\r\n}\r\n\r\n.type-grid {\r\n    margin-top: 14px;\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr;\r\n    gap: 10px;\r\n}\r\n\r\n.type-btn {\r\n    border: 1px solid #e5e7eb;\r\n    background: #f9fafb;\r\n    border-radius: 12px;\r\n    padding: 10px 12px;\r\n    font-size: 13px;\r\n    cursor: pointer;\r\n    transition: 0.15s;\r\n}\r\n\r\n.type-btn:hover {\r\n    transform: translateY(-1px);\r\n}\r\n\r\n.type-btn.active {\r\n    border-color: #667eea;\r\n    background: #eef2ff;\r\n}\r\n\r\n.modal-actions {\r\n    margin-top: 14px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.confirm-btn {\r\n    border: none;\r\n    border-radius: 10px;\r\n    padding: 10px 14px;\r\n    cursor: pointer;\r\n    color: #fff;\r\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n}\r\n\r\n.confirm-btn:hover {\r\n    opacity: 0.9;\r\n}\r\n\r\n.thinking-indicator {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n    padding: 6px 0;\r\n    color: #667eea;\r\n    font-size: 13px;\r\n}\r\n\r\n.thinking-indicator span {\r\n    width: 6px;\r\n    height: 6px;\r\n    border-radius: 50%;\r\n    background: #667eea;\r\n    animation: thinking 1.4s infinite ease-in-out;\r\n}\r\n\r\n.thinking-indicator span:nth-child(1) {\r\n    animation-delay: 0s;\r\n}\r\n.thinking-indicator span:nth-child(2) {\r\n    animation-delay: 0.2s;\r\n}\r\n.thinking-indicator span:nth-child(3) {\r\n    animation-delay: 0.4s;\r\n}\r\n\r\n.thinking-text {\r\n    margin-left: 6px;\r\n    opacity: 0.7;\r\n}\r\n\r\n@keyframes thinking {\r\n    0%,\r\n    80%,\r\n    100% {\r\n        transform: scale(0.6);\r\n        opacity: 0.4;\r\n    }\r\n    40% {\r\n        transform: scale(1);\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n/* ÂìçÂ∫îÂºè */\r\n@media (max-width: 768px) {\r\n    .chat-container {\r\n        padding: 16px 20px;\r\n    }\r\n\r\n    .input-section {\r\n        padding: 12px 20px 16px;\r\n    }\r\n\r\n    .message-content {\r\n        max-width: 85%;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}