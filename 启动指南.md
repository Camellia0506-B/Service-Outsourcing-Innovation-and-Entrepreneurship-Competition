# 职业规划智能体 - 项目启动指南

## 一、环境准备

- **Python 3.x**（用于前端静态服务 + AI 算法服务）
- 前端为静态 HTML，无需 Node.js
- **Java 17 + Maven**（使用 Java 后端 5000 时需要）
- **MySQL 8.x**（使用真实用户/档案数据时需要）
- **DashScope API Key（可选）**：用于 AI 生成职业测评/职业规划的完整报告（没有也能运行基础功能，但部分 AI 生成会降级）

---

## 二、最快启动（推荐）

### 1. 启动前端

- 在**资源管理器**中进入项目根目录（即能看到 `start-frontend.bat` 的目录）
- **双击** `start-frontend.bat`
- 会弹出黑色命令行窗口，出现类似 **`Serving HTTP on 0.0.0.0 port 8888`** 即表示成功
- **不要关闭该窗口**

### 2. 打开页面

- 打开浏览器，在地址栏输入：**http://localhost:8888** 回车
- 即可进入登录页

### 3. 登录（模拟模式）

当前为模拟模式，可直接用以下账号登录：

| 账号   | 密码   |
|--------|--------|
| admin  | 123456 |
| test   | 123456 |

或输入任意账号（≥2 位）和密码（≥6 位）登录。

---

## 三、需要 AI 功能时（职业测评、岗位画像、职业规划报告）

1. **再开一个窗口**：双击 `start-ai.bat`
2. 看到 AI 服务在 **http://127.0.0.1:5001** 启动成功后，前端里的职业测评、岗位画像等会连到该服务
3. 若 `api.js` 里 `mockMode` 为 `true`，可改为 `false` 以使用真实 AI 接口

---

## 四、需要 Java 后端时（登录、个人档案保存等真实数据）

当 `api.js` 中 `mockMode` 为 `false` 时，登录、个人档案等会请求 Java 后端。需先完成以下步骤：

### 1. 准备 MySQL 数据库

1. 安装并启动 MySQL（端口 3306）
2. 创建数据库和用户：
   ```sql
   CREATE DATABASE gradquest CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   CREATE USER 'gradquest'@'localhost' IDENTIFIED BY 'Gradquest123!';
   GRANT ALL ON gradquest.* TO 'gradquest'@'localhost';
   FLUSH PRIVILEGES;
   ```
3. 若项目中有建表 SQL 脚本，在 `gradquest` 库中执行

### 2. 启动 Java 后端

- **方式一（推荐）**：双击 `start-backend.bat`
- **方式二**：在项目根目录打开终端，执行：
  ```bash
  cd backend
  mvn spring-boot:run
  ```
- **方式三**：用 IntelliJ IDEA 打开 `backend` 目录，运行 `GradQuestApplication`

### 3. 确认启动成功

看到类似 **`Tomcat started on port(s): 5000`** 即表示成功，此时 `http://localhost:5000/api/v1` 可访问。

### 4. 运行整个项目（真实后端推荐顺序）

要稳定跑完整功能（登录/档案/测评/岗位画像/职业规划），建议按以下顺序启动并保持窗口不关闭：

1. **启动 MySQL**（确保服务处于 Running）
2. **启动 Java 后端（5000）**
3. **启动 AI 服务（5001）**（需要测评/岗位画像/职业规划时）
4. **启动前端（8888）**，浏览器打开 `http://localhost:8888`

> 若遇到 `ERR_CONNECTION_REFUSED`：哪个端口拒绝连接，就说明对应服务没启动或启动后报错退出（去看那个服务窗口的报错）。

---

## 五、端口说明

| 服务     | 端口 | 说明 |
|----------|------|------|
| 前端     | 8888 | 静态页面，登录、测评、岗位画像等 |
| Java 后端 | 5000 | 登录、个人档案、用户数据等 |
| AI 算法  | 5001 | 职业测评、岗位画像、职业规划报告 |

---

## 六、手动命令行启动（可选）

在 Cursor/VS Code 里用「终端」运行下面命令时，**请用单行**，这样 `cd` 和 `python` 会在同一次执行里生效；若拆成两行再点运行，可能只跑了第一行，服务起不来。

### 1) 如果你用的是 cmd（命令提示符，黑窗口）

**终端 1 - 前端（复制整行运行）：**
```bash
cd /d d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\frontfiles && python -m http.server 8888
```

**终端 2 - AI 服务（可选，端口 5001）：**
```bash
cd /d d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\AI算法 && python app.py
```

如果需要在线大模型生成完整报告，先设置环境变量（可选）：

```bash
set DASHSCOPE_API_KEY=sk-你的密钥
```

**终端 3 - Java 后端（可选，需 MySQL，端口 5000）：**
```bash
cd /d d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\backend && mvn spring-boot:run
```

然后浏览器访问 **http://localhost:8888**。

### 2) 如果你用的是 PowerShell（前缀是 PS）

PowerShell 里 **不要写 `cd /d`**，用 `Set-Location`（或 `cd` 但不要带 `/d`）。

- 前端：`Set-Location "d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\frontfiles"; python -m http.server 8888`
- AI：`$env:DASHSCOPE_API_KEY="sk-你的密钥"; Set-Location "d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\AI算法"; python app.py`
- Java 后端：`Set-Location "d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\backend"; mvn spring-boot:run`

---

## 七、常见问题

### 1. 页面打不开 / 白屏 / ERR_EMPTY_RESPONSE（localhost 未发送任何数据）

- 前端已改为绑定 **127.0.0.1**，请用浏览器访问：**http://127.0.0.1:8888**（若用 localhost 报错可改用此地址）
- 先**双击** `start-frontend.bat`，等窗口里出现 `Serving HTTP` / `port 8888` 后再访问
- **不要**直接双击 `index.html` 用 file:// 打开，否则可能白屏或功能异常

### 2. 双击 bat 没反应或闪退

- 检查是否已安装 Python：打开 CMD 输入 `python --version`
- 若未安装，请安装 Python 3 并勾选「Add Python to PATH」
- 若项目路径包含中文，尽量把项目放在英文路径下再试

### 3. 端口 8888 被占用

- 用记事本打开 `start-frontend.bat`，把其中的 `8888` 改成 `8000`
- 保存后重新运行，浏览器访问 **http://localhost:8000**

### 4. 职业测评 / 岗位画像无数据

- 先运行 `start-ai.bat` 启动 AI 服务（端口 5001）
- 打开 `frontfiles/api.js`，确认 `mockMode` 为 `false`（需要真实 AI 时）

### 5. 登录失败或接口报错

- 将 `frontfiles/api.js` 里的 `mockMode` 改为 `true`，使用本地模拟数据，无需后端即可登录和浏览

### 6. ERR_CONNECTION_REFUSED / 保存个人档案失败

- 表示 Java 后端（5000 端口）未启动
- 先按「四、需要 Java 后端时」配置 MySQL 并启动 `start-backend.bat`
- 或把 `api.js` 里 `mockMode` 改为 `true`，使用模拟数据

### 7. 首页状态文字没更新（仍显示“待测评”等）

- 多数是浏览器缓存导致，代码已经更新但页面还在用旧版本
- 在首页按 **Ctrl + F5**（或 Ctrl + Shift + R）强制刷新
- 如果还不行，用浏览器无痕/隐身模式重新打开 `http://localhost:8888`

### 8. mvn spring-boot:run 报错 “No plugin found for prefix 'spring-boot'”

- 你大概率**不在 `backend` 目录**里运行 Maven
- 先在命令行确认路径是：
  - `d:\Projects\Service-Outsourcing-Innovation-and-Entrepreneurship-Competition\backend>`
- 再执行：`mvn spring-boot:run`

### 9. 5001 端口一直拒绝连接（测评/岗位画像/职业规划都不可用）

- AI 服务没有启动，或启动后报错退出
- 在 `AI算法` 目录运行：`python app.py`
- 看到 `Running on http://127.0.0.1:5001` 才算启动成功；否则请查看窗口里的 Traceback 报错并按提示修复

---

## 八、总结

| 步骤 | 操作 |
|------|------|
| ① | 双击 `start-frontend.bat`，保持窗口打开 |
| ② | 浏览器打开 **http://localhost:8888** |
| ③ | 用 admin / 123456 或任意账号密码登录 |
| ④ | 需要 AI 功能时，再双击 `start-ai.bat` |
| ⑤ | 需要保存个人档案等真实数据时，先配置 MySQL，再双击 `start-backend.bat` |
