{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.iterator.constructor.js\");\nrequire(\"core-js/modules/es.iterator.for-each.js\");\nrequire(\"core-js/modules/es.iterator.map.js\");\nrequire(\"core-js/modules/es.iterator.reduce.js\");\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar layoutObserver = require('../layout-observer.js');\nvar tokens = require('../tokens.js');\nvar styleHelper = require('./style-helper.js');\nvar index = require('../../../../hooks/use-namespace/index.js');\nvar TableFooter = vue.defineComponent({\n  name: \"ElTableFooter\",\n  props: {\n    fixed: {\n      type: String,\n      default: \"\"\n    },\n    store: {\n      required: true,\n      type: Object\n    },\n    summaryMethod: Function,\n    sumText: String,\n    border: Boolean,\n    defaultSort: {\n      type: Object,\n      default: () => {\n        return {\n          prop: \"\",\n          order: \"\"\n        };\n      }\n    }\n  },\n  setup(props) {\n    const parent = vue.inject(tokens.TABLE_INJECTION_KEY);\n    const ns = index.useNamespace(\"table\");\n    const {\n      getCellClasses,\n      getCellStyles,\n      columns\n    } = styleHelper[\"default\"](props);\n    const {\n      onScrollableChange,\n      onColumnsChange\n    } = layoutObserver[\"default\"](parent);\n    return {\n      ns,\n      onScrollableChange,\n      onColumnsChange,\n      getCellClasses,\n      getCellStyles,\n      columns\n    };\n  },\n  render() {\n    const {\n      columns,\n      getCellStyles,\n      getCellClasses,\n      summaryMethod,\n      sumText\n    } = this;\n    const data = this.store.states.data.value;\n    let sums = [];\n    if (summaryMethod) {\n      sums = summaryMethod({\n        columns,\n        data\n      });\n    } else {\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = sumText;\n          return;\n        }\n        const values = data.map(item => Number(item[column.property]));\n        const precisions = [];\n        let notNumber = true;\n        values.forEach(value => {\n          if (!Number.isNaN(+value)) {\n            notNumber = false;\n            const decimal = `${value}`.split(\".\")[1];\n            precisions.push(decimal ? decimal.length : 0);\n          }\n        });\n        const precision = Math.max.apply(null, precisions);\n        if (!notNumber) {\n          sums[index] = values.reduce((prev, curr) => {\n            const value = Number(curr);\n            if (!Number.isNaN(+value)) {\n              return Number.parseFloat((prev + curr).toFixed(Math.min(precision, 20)));\n            } else {\n              return prev;\n            }\n          }, 0);\n        } else {\n          sums[index] = \"\";\n        }\n      });\n    }\n    return vue.h(vue.h(\"tfoot\", [vue.h(\"tr\", {}, [...columns.map((column, cellIndex) => vue.h(\"td\", {\n      key: cellIndex,\n      colspan: column.colSpan,\n      rowspan: column.rowSpan,\n      class: getCellClasses(columns, cellIndex),\n      style: getCellStyles(column, cellIndex)\n    }, [vue.h(\"div\", {\n      class: [\"cell\", column.labelClassName]\n    }, [sums[cellIndex]])]))])]));\n  }\n});\nexports[\"default\"] = TableFooter;","map":{"version":3,"names":["TableFooter","vue","defineComponent","name","props","fixed","type","String","default","store","required","Object","summaryMethod","Function","sumText","border","Boolean","defaultSort","prop","order","setup","parent","inject","tokens","TABLE_INJECTION_KEY","ns","index","useNamespace","getCellClasses","getCellStyles","columns","styleHelper","onScrollableChange","onColumnsChange","layoutObserver","render","data","states","value","sums","forEach","column","values","map","item","Number","property","precisions","notNumber","isNaN","decimal","split","push","length","precision","Math","max","apply","reduce","prev","curr","parseFloat","toFixed","min","h","cellIndex","key","colspan","colSpan","rowspan","rowSpan","class","style","labelClassName"],"sources":["../../../../../../../packages/components/table/src/table-footer/index.ts"],"sourcesContent":["// @ts-nocheck\nimport { defineComponent, h, inject } from 'vue'\nimport { useNamespace } from '@element-plus/hooks'\nimport useLayoutObserver from '../layout-observer'\nimport { TABLE_INJECTION_KEY } from '../tokens'\nimport useStyle from './style-helper'\nimport type { Store } from '../store'\n\nimport type { PropType } from 'vue'\nimport type { DefaultRow, Sort, SummaryMethod } from '../table/defaults'\nexport interface TableFooter<T> {\n  fixed: string\n  store: Store<T>\n  summaryMethod: SummaryMethod<T>\n  sumText: string\n  border: boolean\n  defaultSort: Sort\n}\n\nexport default defineComponent({\n  name: 'ElTableFooter',\n\n  props: {\n    fixed: {\n      type: String,\n      default: '',\n    },\n    store: {\n      required: true,\n      type: Object as PropType<TableFooter<DefaultRow>['store']>,\n    },\n    summaryMethod: Function as PropType<\n      TableFooter<DefaultRow>['summaryMethod']\n    >,\n    sumText: String,\n    border: Boolean,\n    defaultSort: {\n      type: Object as PropType<TableFooter<DefaultRow>['defaultSort']>,\n      default: () => {\n        return {\n          prop: '',\n          order: '',\n        }\n      },\n    },\n  },\n  setup(props) {\n    const parent = inject(TABLE_INJECTION_KEY)\n    const ns = useNamespace('table')\n    const { getCellClasses, getCellStyles, columns } = useStyle(\n      props as TableFooter<DefaultRow>\n    )\n    const { onScrollableChange, onColumnsChange } = useLayoutObserver(parent!)\n\n    return {\n      ns,\n      onScrollableChange,\n      onColumnsChange,\n      getCellClasses,\n      getCellStyles,\n      columns,\n    }\n  },\n  render() {\n    const { columns, getCellStyles, getCellClasses, summaryMethod, sumText } =\n      this\n    const data = this.store.states.data.value\n    let sums = []\n    if (summaryMethod) {\n      sums = summaryMethod({\n        columns,\n        data,\n      })\n    } else {\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = sumText\n          return\n        }\n        const values = data.map((item) => Number(item[column.property]))\n        const precisions = []\n        let notNumber = true\n        values.forEach((value) => {\n          if (!Number.isNaN(+value)) {\n            notNumber = false\n            const decimal = `${value}`.split('.')[1]\n            precisions.push(decimal ? decimal.length : 0)\n          }\n        })\n        const precision = Math.max.apply(null, precisions)\n        if (!notNumber) {\n          sums[index] = values.reduce((prev, curr) => {\n            const value = Number(curr)\n            if (!Number.isNaN(+value)) {\n              return Number.parseFloat(\n                (prev + curr).toFixed(Math.min(precision, 20))\n              )\n            } else {\n              return prev\n            }\n          }, 0)\n        } else {\n          sums[index] = ''\n        }\n      })\n    }\n    return h(\n      h('tfoot', [\n        h('tr', {}, [\n          ...columns.map((column, cellIndex) =>\n            h(\n              'td',\n              {\n                key: cellIndex,\n                colspan: column.colSpan,\n                rowspan: column.rowSpan,\n                class: getCellClasses(columns, cellIndex),\n                style: getCellStyles(column, cellIndex),\n              },\n              [\n                h(\n                  'div',\n                  {\n                    class: ['cell', column.labelClassName],\n                  },\n                  [sums[cellIndex]]\n                ),\n              ]\n            )\n          ),\n        ]),\n      ])\n    )\n  },\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}